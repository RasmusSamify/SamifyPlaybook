<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Samify Sales Dashboard V14 - Fixed Accordion</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- FontAwesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <!-- Zapier Chatbot Script -->
    <script async type='module' src='https://interfaces.zapier.com/assets/web-components/zapier-interfaces/zapier-interfaces.esm.js'></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Montserrat:wght@400;600;700&display=swap');
        
        * { font-family: 'Inter', sans-serif; }
        body { overflow: hidden; background-color: #f1f5f9; }

        /* Custom Scrollbar */
        .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #e2e8f0; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 3px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #64748b; }

        /* Animations */
        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Phase Button Active State */
        .phase-btn.active {
            background-color: white;
            color: #312e81; /* Indigo-900 */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transform: translateY(-1px);
        }

        /* Tabs */
        .sub-tab.active {
            border-bottom: 2px solid #4f46e5;
            color: #4f46e5;
            background-color: #eef2ff;
        }

        /* ROI Toggle Switch */
        .lever-card { transition: all 0.2s ease; border: 1px solid #e2e8f0; }
        .lever-card.active { border-color: #4f46e5; background-color: #f5f3ff; box-shadow: 0 2px 5px rgba(79, 70, 229, 0.1); }
        .lever-checkbox { accent-color: #4f46e5; width: 1.2rem; height: 1.2rem; }

        /* Script Flow Styles */
        .script-block { border-left: 3px solid #cbd5e1; padding-left: 1.5rem; margin-bottom: 2rem; position: relative; opacity: 0.5; transition: all 0.3s ease; }
        .script-block.active { border-left-color: #4f46e5; opacity: 1; }
        .script-block::before { content: ''; position: absolute; left: -10px; top: 0; width: 17px; height: 17px; border-radius: 50%; background: #cbd5e1; border: 3px solid #fff; }
        .script-block.active::before { background: #4f46e5; }

        .pitch-btn-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 0.5rem; }

        /* Objection Accordion Logic */
        .objection-content { 
            max-height: 0; 
            overflow: hidden; 
            transition: max-height 0.4s ease-out, opacity 0.4s ease-out;
            opacity: 0;
        }
        .objection-content.open { 
            max-height: 500px; /* Safe max-height to allow content */
            opacity: 1;
        }
        .rotate-180 {
            transform: rotate(180deg);
        }

        /* Form Styles (Scoped) */
        #behovsanalys-container { background: #ffffff; color: #1e293b; position: relative; }
        #behovsanalys-container .form-step { display: none; animation: fadeIn 0.4s ease-out; }
        #behovsanalys-container .form-step.active { display: block; }
        #behovsanalys-container h3 { margin-top: 0; color: #0f172a; font-size: 1.5rem; margin-bottom: 10px; font-weight: 700; }
        #behovsanalys-container p.step-desc { color: #64748b; margin-bottom: 25px; line-height: 1.5; font-size: 0.95rem; }
        #behovsanalys-container label { display: block; margin-bottom: 6px; font-weight: 600; font-size: 0.9rem; color: #334155; }
        #behovsanalys-container input[type="text"], #behovsanalys-container input[type="email"], #behovsanalys-container input[type="tel"], #behovsanalys-container textarea, #behovsanalys-container select { width: 100%; padding: 12px 16px; margin-bottom: 20px; border: 1px solid #cbd5e1; border-radius: 8px; box-sizing: border-box; font-size: 14px; background: #f8fafc; transition: border 0.2s, box-shadow 0.2s; }
        #behovsanalys-container input:focus, #behovsanalys-container textarea:focus, #behovsanalys-container select:focus { border-color: #2563eb; background: #fff; outline: none; box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1); }
        #behovsanalys-container .radio-group { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        #behovsanalys-container .radio-card { position: relative; }
        #behovsanalys-container .radio-card input { opacity: 0; position: absolute; width: 0; }
        #behovsanalys-container .radio-card label { display: block; padding: 12px; border: 1px solid #cbd5e1; border-radius: 8px; text-align: center; cursor: pointer; background: #fff; transition: all 0.2s; font-weight: 500; margin: 0; font-size: 14px; }
        #behovsanalys-container .radio-card input:checked + label { border-color: #2563eb; background-color: #eff6ff; color: #2563eb; font-weight: 700; }
        #behovsanalys-container .btn-group { display: flex; justify-content: space-between; margin-top: 30px; padding-top: 20px; border-top: 1px solid #f1f5f9; }
        #behovsanalys-container button.form-btn { padding: 12px 28px; border: none; border-radius: 50px; cursor: pointer; font-size: 14px; font-weight: 600; transition: transform 0.2s, background 0.2s; }
        #behovsanalys-container .btn-next, #behovsanalys-container .btn-submit { background: linear-gradient(90deg, #2563eb 0%, #1d4ed8 100%); color: white; box-shadow: 0 4px 12px rgba(37, 99, 235, 0.2); }
        #behovsanalys-container .btn-prev { background-color: white; color: #64748b; border: 1px solid #cbd5e1; }
        #behovsanalys-container .btn-next:hover, #behovsanalys-container .btn-submit:hover { transform: translateY(-1px); box-shadow: 0 6px 15px rgba(37, 99, 235, 0.3); }
        #behovsanalys-container .progress-wrapper { margin-bottom: 30px; }
        #behovsanalys-container .progress-bg { background-color: #f1f5f9; height: 6px; border-radius: 3px; overflow: hidden; }
        #behovsanalys-container .progress-bar { background-color: #2563eb; height: 100%; width: 0%; transition: width 0.4s ease; }
        #behovsanalys-container .step-indicator { text-align: right; font-size: 0.75rem; color: #94a3b8; margin-top: 5px; font-weight: 600; }
        #success-message { text-align: center; display: none; padding: 20px; }
        #success-message h3 { color: #22c55e; font-size: 2rem; margin-bottom: 10px; }
        #success-message p { color: #475569; font-size: 1.1rem; }
    </style>
</head>
<body class="h-screen flex flex-col text-slate-800">

    <!-- HEADER -->
    <header class="bg-gradient-to-r from-slate-900 via-indigo-900 to-slate-900 text-white px-6 py-3 shadow-lg shrink-0 z-30 h-16 flex items-center justify-between">
        <div class="flex items-center gap-3">
            <div class="bg-white/10 p-2 rounded-lg backdrop-blur-sm border border-white/10">
                <i class="fa-solid fa-bolt text-yellow-400"></i>
            </div>
            <div>
                <h1 class="font-bold text-lg tracking-tight leading-none">Samify <span class="font-light opacity-70">OS</span></h1>
                <div class="flex items-center gap-2 text-[10px] text-indigo-200 mt-1">
                    <span class="w-1.5 h-1.5 bg-green-400 rounded-full animate-pulse"></span>
                    Sales Dashboard V14
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="flex gap-2 bg-black/20 p-1 rounded-xl border border-white/5">
            <button onclick="setPhase('discovery')" id="btn-discovery" class="phase-btn active px-4 py-1.5 rounded-lg text-sm font-semibold transition-all flex items-center gap-2">
                <i class="fa-solid fa-calculator"></i> 1. Uppt√§ck & ROI
            </button>
            <button onclick="setPhase('presentation')" id="btn-presentation" class="phase-btn px-4 py-1.5 rounded-lg text-sm font-semibold transition-all flex items-center gap-2 text-indigo-100 hover:bg-white/10">
                <i class="fa-solid fa-microphone-lines"></i> 2. S√§ljmanus (Live)
            </button>
            <button onclick="setPhase('objection')" id="btn-objection" class="phase-btn px-4 py-1.5 rounded-lg text-sm font-semibold transition-all flex items-center gap-2 text-indigo-100 hover:bg-white/10">
                <i class="fa-solid fa-shield-halved"></i> 3. Hantera
            </button>
            <button onclick="setPhase('closing')" id="btn-closing" class="phase-btn px-4 py-1.5 rounded-lg text-sm font-semibold transition-all flex items-center gap-2 text-indigo-100 hover:bg-white/10">
                <i class="fa-solid fa-check"></i> 4. St√§ng
            </button>
        </div>

        <div class="flex gap-3">
            <button class="w-8 h-8 rounded-full bg-white/10 hover:bg-white/20 flex items-center justify-center transition">
                <i class="fa-solid fa-user text-sm"></i>
            </button>
        </div>
    </header>

    <!-- MAIN CONTAINER -->
    <div class="flex-1 flex overflow-hidden min-h-0 bg-slate-100">

        <!-- COLUMN 1: ARBETSYTA (75%) -->
        <main class="w-3/4 flex flex-col border-r border-slate-200 relative overflow-hidden bg-white">
            
            <!-- VIEW 1: DISCOVERY & ROI -->
            <div id="view-discovery" class="phase-view h-full flex flex-col overflow-hidden">
                <div class="bg-indigo-50 border-b border-indigo-100 px-8 py-4 shrink-0 flex justify-between items-center">
                    <div>
                        <h2 class="text-xl font-bold text-indigo-900"><i class="fa-solid fa-magnifying-glass mr-2"></i>Steg 1: Analysera & Kalkylera</h2>
                        <p class="text-sm text-indigo-600">Bygg caset i ROI-kalkylatorn (V√§nster) och fyll i Behovsanalysen (H√∂ger).</p>
                    </div>
                </div>

                <div class="flex-1 flex overflow-hidden">
                    <!-- LEFT SPLIT: REALISTIC ROI CALCULATOR -->
                    <div class="w-1/2 overflow-y-auto custom-scrollbar p-6 bg-slate-50 border-r border-slate-200">
                        <div class="max-w-xl mx-auto">
                            <!-- ROI Calculator Content -->
                            <div class="flex justify-between items-center mb-4">
                                <h3 class="font-bold text-slate-700 flex items-center gap-2"><i class="fa-solid fa-calculator text-indigo-500"></i> ROI Kalkylator</h3>
                                <span class="text-[10px] bg-white border border-slate-200 px-2 py-1 rounded text-slate-500">Inkl. 45% Overhead</span>
                            </div>
                            
                            <!-- 1. Salary & Employees -->
                            <div class="mb-5 bg-white p-5 rounded-xl border border-slate-200 shadow-sm">
                                <div class="mb-4">
                                    <label class="block text-xs font-bold text-slate-500 uppercase mb-2">1. Snittl√∂n (per person)</label>
                                    <select id="roi-salary-level" onchange="calculateROI()" class="w-full p-3 border border-slate-200 rounded-lg text-sm bg-slate-50 font-medium focus:ring-2 focus:ring-indigo-500 outline-none">
                                        <option value="43500">Junior / Mindre ort (43 500 kr)</option>
                                        <option value="55100" selected>Median / Standard (55 100 kr)</option>
                                        <option value="68000">Senior / Storstad (68 000 kr)</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs font-bold text-slate-500 uppercase mb-2">2. Antal anst√§llda (som ber√∂rs)</label>
                                    <div class="flex items-center gap-3">
                                        <input type="number" id="roi-employees" value="1" min="1" onchange="calculateROI()" class="w-20 p-3 border border-slate-200 rounded-lg text-sm bg-slate-50 font-bold text-center focus:ring-2 focus:ring-indigo-500 outline-none">
                                        <span class="text-xs text-slate-400">st personer som sparar tid.</span>
                                    </div>
                                </div>
                            </div>

                            <div class="mb-5 bg-white p-5 rounded-xl border border-slate-200 shadow-sm">
                                <label class="block text-xs font-bold text-slate-500 uppercase mb-4">3. ROI H√§vst√§nger</label>
                                <div class="mb-6 pb-4 border-b border-slate-100">
                                    <div class="flex justify-between mb-2">
                                        <span class="text-sm font-bold text-slate-700 flex items-center gap-2"><i class="fa-regular fa-clock text-indigo-500"></i> Tidsst√∂ld (per person)</span>
                                        <span class="text-indigo-600 font-bold" id="roi-hours-display">2 h/dag</span>
                                    </div>
                                    <input type="range" id="roi-hours" min="0" max="8" value="2" step="0.5" oninput="calculateROI()" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-indigo-600">
                                    <p class="text-[10px] text-slate-400 mt-1 italic">"M√§nskligt lim" mellan system.</p>
                                </div>
                                <div class="space-y-3">
                                    <div class="lever-card p-3 rounded-lg flex items-start gap-3 cursor-pointer" onclick="toggleLever('roi-closing')">
                                        <input type="checkbox" id="roi-closing" onchange="calculateROI()" class="lever-checkbox mt-1">
                                        <div><span class="block text-sm font-bold text-slate-700">üìâ Bokslutspivoten</span><span class="text-xs text-slate-500">Korta bokslutet (5 dagar -> 4h).</span></div>
                                    </div>
                                    <div class="lever-card p-3 rounded-lg flex items-start gap-3 cursor-pointer" onclick="toggleLever('roi-error')">
                                        <input type="checkbox" id="roi-error" onchange="calculateROI()" class="lever-checkbox mt-1">
                                        <div><span class="block text-sm font-bold text-slate-700">‚úÖ Felmarginalskostnad</span><span class="text-xs text-slate-500">Minska felaktiga ordrar/fakturor.</span></div>
                                    </div>
                                    <div class="lever-card p-3 rounded-lg flex items-start gap-3 cursor-pointer" onclick="toggleLever('roi-scale')">
                                        <input type="checkbox" id="roi-scale" onchange="calculateROI()" class="lever-checkbox mt-1">
                                        <div><span class="block text-sm font-bold text-slate-700">üöÄ Skalbarhet</span><span class="text-xs text-slate-500">Undvik nyanst√§llning vid tillv√§xt.</span></div>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-slate-800 text-white p-6 rounded-xl shadow-lg relative overflow-hidden">
                                <div class="absolute top-0 right-0 w-32 h-32 bg-green-500 rounded-full blur-3xl opacity-20 -mr-10 -mt-10"></div>
                                <div class="relative z-10">
                                    <p class="text-slate-400 text-xs uppercase font-bold mb-1">Netto Besparing √Ör 1</p>
                                    <p class="text-3xl font-bold text-green-400" id="res-money">0 kr</p>
                                    <p class="text-xs text-slate-500 mt-2">*Efter avdrag f√∂r startavgift & m√•nadskostnad.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- RIGHT SPLIT: FULL NEEDS ANALYSIS FORM -->
                    <div class="w-1/2 overflow-y-auto custom-scrollbar p-6 bg-white">
                        <div id="behovsanalys-container">
                            <div id="success-message">
                                <h3>Tack! üöÄ</h3>
                                <p>Din analys √§r inskickad. Vi h√∂r av oss inom kort!</p>
                                <button onclick="location.reload()" class="mt-4 text-blue-600 underline">Starta om</button>
                            </div>

                            <div id="form-content-wrapper">
                                <div class="progress-wrapper">
                                    <div class="progress-bg"><div class="progress-bar" id="progressBar"></div></div>
                                    <div class="step-indicator">Steg <span id="stepCount">1</span> av 5</div>
                                </div>

                                <form id="customForm" action="https://hooks.zapier.com/hooks/catch/25909526/ue4p4vt/" method="POST">
                                    <!-- STEG 1 -->
                                    <div class="form-step active" data-step="1">
                                        <h3>Grundl√§ggande Info üè¢</h3>
                                        <p class="step-desc">F√∂r att vi ska f√∂rst√• din verksamhets storlek och struktur.</p>
                                        <label>Ditt namn</label>
                                        <input type="text" name="namn" required placeholder="F√∂rnamn Efternamn" />
                                        <div class="radio-group" style="margin-bottom:0">
                                            <div style="flex:1;margin-right:10px">
                                                <label>F√∂retagsnamn</label>
                                                <input type="text" name="foretag" required placeholder="Bolaget AB" />
                                            </div>
                                            <div style="flex:1">
                                                <label>Bransch</label>
                                                <input type="text" name="bransch" required placeholder="T.ex. Retail / Konsult" />
                                            </div>
                                        </div>
                                        <label>Din roll</label>
                                        <select name="roll" required>
                                            <option value disabled selected>V√§lj din roll...</option>
                                            <option value="VD/√Ñgare">VD / Grundare / √Ñgare</option>
                                            <option value="Marknad/S√§ljchef">Marknads- / S√§ljchef</option>
                                            <option value="Admin/Operations">Admin / Operations</option>
                                            <option value="Annat">Annat</option>
                                        </select>
                                        <label>Antal anst√§llda (Totalt)</label>
                                        <div class="radio-group">
                                            <div class="radio-card"><input type="radio" name="anstallda" id="size1" value="1-5" checked /><label for="size1">1-5</label></div>
                                            <div class="radio-card"><input type="radio" name="anstallda" id="size2" value="6-20" /><label for="size2">6-20</label></div>
                                            <div class="radio-card"><input type="radio" name="anstallda" id="size3" value="21-50" /><label for="size3">21-50</label></div>
                                            <div class="radio-card"><input type="radio" name="anstallda" id="size4" value="50+" /><label for="size4">50+</label></div>
                                        </div>
                                        <div class="btn-group" style="justify-content:flex-end">
                                            <button type="button" class="form-btn btn-next">N√§sta steg ‚ûî</button>
                                        </div>
                                    </div>

                                    <!-- STEG 2 -->
                                    <div class="form-step" data-step="2">
                                        <h3>Era System üíª</h3>
                                        <p class="step-desc">Vilka verktyg anv√§nder ni idag?</p>
                                        <label>E-handelsplattform / Hemsida</label>
                                        <input type="text" name="system_webb" placeholder="T.ex. Shopify, WooCommerce..." />
                                        <label>Aff√§rs- &amp; Bokf√∂ringssystem</label>
                                        <input type="text" name="system_erp" placeholder="T.ex. Fortnox, Visma..." />
                                        <label>CRM / S√§ljst√∂d</label>
                                        <input type="text" name="system_crm" placeholder="T.ex. HubSpot, Pipedrive..." />
                                        <label>Kommunikation</label>
                                        <div class="radio-group">
                                            <div class="radio-card"><input type="radio" name="system_comm" id="comm1" value="Slack" /><label for="comm1">Slack</label></div>
                                            <div class="radio-card"><input type="radio" name="system_comm" id="comm2" value="Teams" /><label for="comm2">Teams</label></div>
                                            <div class="radio-card"><input type="radio" name="system_comm" id="comm3" value="Google" /><label for="comm3">Google/Email</label></div>
                                            <div class="radio-card"><input type="radio" name="system_comm" id="comm4" value="Annat" /><label for="comm4">Annat</label></div>
                                        </div>
                                        <div class="btn-group">
                                            <button type="button" class="form-btn btn-prev">‚¨Ö Tillbaka</button>
                                            <button type="button" class="form-btn btn-next">N√§sta steg ‚ûî</button>
                                        </div>
                                    </div>

                                    <!-- STEG 3 -->
                                    <div class="form-step" data-step="3">
                                        <h3>Processer &amp; Utmaningar ‚öôÔ∏è</h3>
                                        <p class="step-desc">Var skaver det mest?</p>
                                        <label>Prim√§rt m√•l med automation?</label>
                                        <select name="goal_primary">
                                            <option value disabled selected>Vad √§r viktigast?</option>
                                            <option value="Spara tid">Spara tid / Minska admin</option>
                                            <option value="√ñka f√∂rs√§ljning">√ñka f√∂rs√§ljning / Konvertering</option>
                                            <option value="Minska fel">Minska manuella fel</option>
                                            <option value="Kundn√∂jdhet">B√§ttre kundupplevelse</option>
                                        </select>
                                        <label>Beskriv manuellt arbete ni g√∂r idag</label>
                                        <textarea name="process_manual_tasks" rows="3" placeholder="Vi l√§gger mycket tid p√• att..."></textarea>
                                        <label>Uppskattad tid p√• admin/vecka?</label>
                                        <div class="radio-group">
                                            <div class="radio-card"><input type="radio" name="time_waste" id="tw1" value="0-5h" /><label for="tw1">0-5 tim</label></div>
                                            <div class="radio-card"><input type="radio" name="time_waste" id="tw2" value="5-10h" /><label for="tw2">5-10 tim</label></div>
                                            <div class="radio-card"><input type="radio" name="time_waste" id="tw3" value="10-20h" /><label for="tw3">10-20 tim</label></div>
                                            <div class="radio-card"><input type="radio" name="time_waste" id="tw4" value="20h+" /><label for="tw4">20+ tim</label></div>
                                        </div>
                                        <label>Order/Transaktionsvolym per m√•nad (ca)</label>
                                        <input type="text" name="volume" placeholder="T.ex. 50 ordrar/m√•n" />
                                        <div class="btn-group">
                                            <button type="button" class="form-btn btn-prev">‚¨Ö Tillbaka</button>
                                            <button type="button" class="form-btn btn-next">N√§sta steg ‚ûî</button>
                                        </div>
                                    </div>

                                    <!-- STEG 4 -->
                                    <div class="form-step" data-step="4">
                                        <h3>Kundtj√§nst &amp; AI ü§ñ</h3>
                                        <p class="step-desc">Om ni √§r intresserade av chatbots/AI-assistenter.</p>
                                        <label>Hur sker support idag?</label>
                                        <input type="text" name="support_current" placeholder="T.ex. Mail, telefon, Facebook..." />
                                        <label>Vanligaste √•terkommande fr√•gorna?</label>
                                        <textarea name="support_faq" rows="2" placeholder="T.ex. 'Var √§r mitt paket?', '√ñppettider'..."></textarea>
                                        <label>Om ni skaffar en AI-bot, vad ska den g√∂ra?</label>
                                        <select name="bot_goal">
                                            <option value="Support">Support &amp; Avlastning</option>
                                            <option value="Sales">S√§ljst√∂d &amp; Leads</option>
                                            <option value="Both">B√•de och</option>
                                            <option value="NotInterested">Ej aktuellt just nu</option>
                                        </select>
                                        <div class="btn-group">
                                            <button type="button" class="form-btn btn-prev">‚¨Ö Tillbaka</button>
                                            <button type="button" class="form-btn btn-next">Sista steget ‚ûî</button>
                                        </div>
                                    </div>

                                    <!-- STEG 5 -->
                                    <div class="form-step" data-step="5">
                                        <h3>Slutspurten! üöÄ</h3>
                                        <p class="step-desc">L√§mna dina kontaktuppgifter.</p>
                                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:15px">
                                            <div>
                                                <label>Start</label>
                                                <select name="timeline">
                                                    <option value="ASAP">Snarast</option>
                                                    <option value="1 month">1 m√•n</option>
                                                    <option value="Q3/Q4">Senare</option>
                                                </select>
                                            </div>
                                            <div>
                                                <label>Budget</label>
                                                <select name="budget">
                                                    <option value="Start">Startpaket</option>
                                                    <option value="Mid">Helhet</option>
                                                    <option value="Unknown">Vet ej</option>
                                                </select>
                                            </div>
                                        </div>
                                        <label>Telefonnummer</label>
                                        <input type="tel" name="telefon" required placeholder="070-123 45 67" />
                                        <label>Din e-postadress</label>
                                        <input type="email" name="email" required placeholder="namn@foretag.se" style="border:2px solid #e2e8f0" />
                                        <label>√ñnskem√•l om tid f√∂r kontakt?</label>
                                        <input type="text" name="contact_time" placeholder="T.ex. Tisdag f√∂rmiddag" />
                                        <div class="btn-group">
                                            <button type="button" class="form-btn btn-prev">‚¨Ö Tillbaka</button>
                                            <button type="submit" class="form-btn btn-submit">Skicka analys</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 2: INTERACTIVE SALES SCRIPT FLOW -->
            <div id="view-presentation" class="phase-view hidden h-full flex flex-col">
                <div class="border-b border-slate-200 px-8 py-4 shrink-0 bg-white shadow-sm flex justify-between items-center">
                    <h2 class="font-bold text-slate-800 flex items-center gap-2">
                        <span class="bg-indigo-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-xs">2</span>
                        V√§lj Inledning f√∂r att starta fl√∂det
                    </h2>
                    <button onclick="resetScript()" class="text-xs text-slate-400 hover:text-slate-600"><i class="fa-solid fa-rotate-right"></i> √Öterst√§ll</button>
                </div>
                
                <div class="flex-1 flex overflow-hidden">
                    <!-- LEFT: PITCH SELECTION -->
                    <div class="w-1/3 bg-slate-50 border-r border-slate-200 overflow-y-auto custom-scrollbar p-6">
                        <p class="text-xs font-bold text-slate-400 uppercase mb-4 tracking-wider">V√§lj Scenario</p>
                        <div class="space-y-3">
                            <button onclick="startFlow('straight')" class="pitch-select-btn w-full text-left p-4 bg-white border border-slate-200 rounded-xl shadow-sm hover:border-indigo-400 hover:shadow-md transition group">
                                <div class="flex items-center gap-3">
                                    <span class="text-2xl group-hover:scale-110 transition">üéØ</span>
                                    <div>
                                        <span class="block font-bold text-slate-700 text-sm">Raka & √Ñrliga</span>
                                        <span class="text-[10px] text-slate-500">Stressade chefer / VD</span>
                                    </div>
                                </div>
                            </button>

                            <button onclick="startFlow('cfo')" class="pitch-select-btn w-full text-left p-4 bg-white border border-slate-200 rounded-xl shadow-sm hover:border-indigo-400 hover:shadow-md transition group">
                                <div class="flex items-center gap-3">
                                    <span class="text-2xl group-hover:scale-110 transition">üí∞</span>
                                    <div>
                                        <span class="block font-bold text-slate-700 text-sm">CFO / Ekonomi</span>
                                        <span class="text-[10px] text-slate-500">Fokus l√∂nsamhet & bokslut</span>
                                    </div>
                                </div>
                            </button>

                            <button onclick="startFlow('pain')" class="pitch-select-btn w-full text-left p-4 bg-white border border-slate-200 rounded-xl shadow-sm hover:border-indigo-400 hover:shadow-md transition group">
                                <div class="flex items-center gap-3">
                                    <span class="text-2xl group-hover:scale-110 transition">ü§ï</span>
                                    <div>
                                        <span class="block font-bold text-slate-700 text-sm">Sm√§rtan (Operativ)</span>
                                        <span class="text-[10px] text-slate-500">S√§ljchefer / Admin</span>
                                    </div>
                                </div>
                            </button>

                            <button onclick="startFlow('scale')" class="pitch-select-btn w-full text-left p-4 bg-white border border-slate-200 rounded-xl shadow-sm hover:border-indigo-400 hover:shadow-md transition group">
                                <div class="flex items-center gap-3">
                                    <span class="text-2xl group-hover:scale-110 transition">üìà</span>
                                    <div>
                                        <span class="block font-bold text-slate-700 text-sm">Skalbarhet</span>
                                        <span class="text-[10px] text-slate-500">Gaseller / Startups</span>
                                    </div>
                                </div>
                            </button>
                            
                             <button onclick="startFlow('social')" class="pitch-select-btn w-full text-left p-4 bg-white border border-slate-200 rounded-xl shadow-sm hover:border-indigo-400 hover:shadow-md transition group">
                                <div class="flex items-center gap-3">
                                    <span class="text-2xl group-hover:scale-110 transition">ü§ù</span>
                                    <div>
                                        <span class="block font-bold text-slate-700 text-sm">Igenk√§nning</span>
                                        <span class="text-[10px] text-slate-500">Vet system (Fortnox/Shopify)</span>
                                    </div>
                                </div>
                            </button>
                            
                            <button onclick="startFlow('curious')" class="pitch-select-btn w-full text-left p-4 bg-white border border-slate-200 rounded-xl shadow-sm hover:border-indigo-400 hover:shadow-md transition group">
                                <div class="flex items-center gap-3">
                                    <span class="text-2xl group-hover:scale-110 transition">ü§î</span>
                                    <div>
                                        <span class="block font-bold text-slate-700 text-sm">Nyfikenhet</span>
                                        <span class="text-[10px] text-slate-500">Mjuk √∂ppning</span>
                                    </div>
                                </div>
                            </button>
                        </div>
                    </div>

                    <!-- RIGHT: INTERACTIVE SCRIPT FLOW -->
                    <div class="w-2/3 bg-white p-8 overflow-y-auto custom-scrollbar relative" id="script-container">
                        
                        <!-- Placeholder State -->
                        <div id="script-placeholder" class="h-full flex flex-col items-center justify-center text-slate-400 opacity-60">
                            <i class="fa-solid fa-arrow-left text-4xl mb-4"></i>
                            <p>V√§lj en inledning till v√§nster</p>
                        </div>

                        <!-- LIVE SCRIPT CONTENT -->
                        <div id="script-content" class="hidden max-w-2xl mx-auto pb-20">
                            
                            <!-- FAS 1: √ñPPNING -->
                            <div id="step-1" class="script-block active">
                                <h4 class="text-xs font-bold text-green-600 uppercase mb-2 tracking-wider">üü¢ Fas 1: √ñppning & Hook</h4>
                                <div class="bg-green-50 p-6 rounded-2xl border border-green-100 shadow-sm mb-4">
                                    <p class="text-lg text-slate-800 font-medium whitespace-pre-line leading-relaxed" id="script-opener-text">...</p>
                                </div>
                                <button onclick="nextStep(2)" class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg font-bold text-sm shadow-md transition transform hover:scale-105">
                                    Kund bekr√§ftar - G√• vidare <i class="fa-solid fa-arrow-down ml-2"></i>
                                </button>
                            </div>

                            <!-- FAS 2: FR√ÖGOR (Dynamisk) -->
                            <div id="step-2" class="script-block hidden">
                                <h4 class="text-xs font-bold text-indigo-600 uppercase mb-2 tracking-wider">üü° Fas 2: Behovsanalys (<span id="track-name">SP√ÖR X</span>)</h4>
                                <div class="bg-indigo-50 p-6 rounded-2xl border border-indigo-100 shadow-sm mb-4">
                                    <p class="text-sm text-indigo-800 font-bold mb-4 border-b border-indigo-200 pb-2">St√§ll dessa fr√•gor:</p>
                                    <ul class="space-y-4" id="script-questions-list">
                                        <!-- Questions injected here -->
                                    </ul>
                                </div>
                                <button onclick="nextStep(3)" class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg font-bold text-sm shadow-md transition transform hover:scale-105">
                                    F√•tt svar - G√• till Diagnos <i class="fa-solid fa-arrow-down ml-2"></i>
                                </button>
                            </div>

                            <!-- FAS 3: DIAGNOS -->
                            <div id="step-3" class="script-block hidden">
                                <h4 class="text-xs font-bold text-orange-500 uppercase mb-2 tracking-wider">üü† Fas 3: Diagnos & Pitch</h4>
                                <div class="bg-orange-50 p-6 rounded-2xl border border-orange-100 shadow-sm mb-4">
                                    <p class="text-base text-slate-700 italic leading-relaxed">
                                        "Tack f√∂r att du delar med dig. Baserat p√• det du s√§ger ‚Äì att ni l√§gger tid p√• <strong>[N√§mn problem]</strong> och vill undvika <strong>[N√§mn risk]</strong>... s√• √§r ni ett skolboksexempel p√• varf√∂r vi finns.<br><br>
                                        Vi s√§ljer inte ett nytt IT-system. Vi fungerar som en <strong>'Automation as a Service'</strong>. Vi kopplar ihop era befintliga system s√• att datan flyter automatiskt.<br><br>
                                        T√§nk dig att den d√§r ordern bokf√∂rs direkt, eller att s√§ljaren slipper admin-arbetet helt. Vi garanterar driften s√• ni slipper oroa er f√∂r teknikstrul."
                                    </p>
                                </div>
                                <button onclick="nextStep(4)" class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg font-bold text-sm shadow-md transition transform hover:scale-105">
                                    G√• p√• Avslut <i class="fa-solid fa-arrow-down ml-2"></i>
                                </button>
                            </div>

                            <!-- FAS 4: AVSLUT -->
                            <div id="step-4" class="script-block hidden">
                                <h4 class="text-xs font-bold text-red-500 uppercase mb-2 tracking-wider">üî¥ Fas 4: Boka M√∂tet</h4>
                                <div class="bg-red-50 p-6 rounded-2xl border border-red-100 shadow-sm mb-4">
                                    <p class="text-lg text-slate-800 font-bold leading-relaxed">
                                        "Jag varken kan eller vill l√∂sa hela er struktur p√• telefon. Men min kollega Adnan √§r specialist p√• just [Deras System].<br><br>
                                        Vi brukar ta en 15-minuters demo d√§r vi visar exakt hur vi l√∂st [Deras Problem] f√∂r andra bolag i er bransch.<br><br>
                                        Om vi kan visa ett s√§tt att spara de d√§r timmarna vi pratade om ‚Äì har du m√∂jlighet <span class="text-red-600 bg-red-100 px-1">tisdag f√∂rmiddag eller torsdag eftermiddag</span> f√∂r att kika p√• det?"
                                    </p>
                                </div>
                                <div class="flex gap-3">
                                    <button onclick="setPhase('closing')" class="bg-green-600 hover:bg-green-700 text-white px-8 py-3 rounded-xl font-bold text-sm shadow-lg transition transform hover:scale-105 flex items-center gap-2">
                                        <i class="fa-solid fa-calendar-check"></i> Ja - Boka nu
                                    </button>
                                    <button onclick="document.getElementById('quick-counters').classList.remove('hidden')" class="bg-white border border-slate-300 text-slate-600 px-4 py-3 rounded-xl font-bold text-sm hover:bg-slate-50">
                                        Fick nej? (Inv√§ndning)
                                    </button>
                                </div>
                                
                                <!-- Quick Counters (Hidden by default) -->
                                <div id="quick-counters" class="hidden mt-6 pt-6 border-t border-slate-200 grid grid-cols-1 gap-2 animate-[fadeIn_0.3s_ease-out]">
                                    <div class="text-xs font-bold text-slate-400 uppercase mb-2">R√§ddningsplankor</div>
                                    <div class="bg-slate-50 p-3 rounded-lg text-sm border border-slate-200">
                                        <strong class="text-slate-800">"Har IT-kille/G√∂r sj√§lva"</strong><br>
                                        <span class="text-slate-600 italic">"Kanon! Men vill ni att han ska l√§gga tid p√• att underh√•lla kopplingar eller bygga v√§rde? Vi sk√∂ter driften (Ops) s√• ni slipper avbrott."</span>
                                    </div>
                                    <div class="bg-slate-50 p-3 rounded-lg text-sm border border-slate-200">
                                        <strong class="text-slate-800">"F√∂r dyrt"</strong><br>
                                        <span class="text-slate-600 italic">"J√§mf√∂rt med m√§nskliga fel eller en nyanst√§llning √§r detta en br√•kdel. L√•t oss r√§kna p√• ROI i m√∂tet."</span>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 3: OBJECTIONS & ARSENAL (20 QUESTIONS) -->
            <div id="view-objection" class="phase-view hidden h-full flex flex-col p-8 overflow-y-auto custom-scrollbar">
                <div class="flex gap-8 h-full">
                    <!-- LEFT: OBJECTIONS -->
                    <div class="w-1/2 flex flex-col">
                        <h3 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2"><i class="fa-solid fa-shield-halved text-indigo-500"></i> Inv√§ndningar (Motst√•nd)</h3>
                        <div class="relative mb-4">
                            <i class="fa-solid fa-search absolute left-4 top-3.5 text-slate-400"></i>
                            <input type="text" id="objSearch" placeholder="S√∂k motargument..." class="w-full pl-10 pr-4 py-3 rounded-lg border border-slate-200 shadow-sm outline-none transition focus:border-indigo-500 text-sm">
                        </div>
                        <div id="objections-list" class="flex-1 overflow-y-auto custom-scrollbar space-y-3 pr-2"></div>
                    </div>

                    <!-- RIGHT: ARSENAL (20 QUESTIONS) -->
                    <div class="w-1/2 flex flex-col">
                        <h3 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2"><i class="fa-solid fa-clipboard-question text-green-500"></i> Arsenalen (20 Fr√•gor)</h3>
                        <div id="arsenal-list" class="flex-1 overflow-y-auto custom-scrollbar space-y-4 pr-2"></div>
                    </div>
                </div>
            </div>

            <!-- VIEW 4: CLOSING (CALENDLY) -->
            <div id="view-closing" class="phase-view hidden h-full flex flex-col p-8 overflow-y-auto custom-scrollbar items-center">
                <h3 class="text-2xl font-bold text-slate-700 mb-6">Boka in kunden</h3>
                <div class="calendly-inline-widget" data-url="https://calendly.com/samify-info/30min" style="min-width:320px;height:700px;width:100%;"></div>
                <script type="text/javascript" src="https://assets.calendly.com/assets/external/widget.js" async></script>
            </div>

        </main>

        <!-- COLUMN 2: AI & VALUE (Right - 25% Width) -->
        <aside class="w-1/4 min-w-[350px] bg-white border-l border-slate-200 flex flex-col shrink-0 shadow-xl z-20 relative">
             <div class="h-[80%] w-full relative bg-slate-50 border-b border-slate-200 flex flex-col">
                 <div class="p-3 bg-white border-b border-slate-100 flex justify-between items-center shrink-0 h-12">
                    <h3 class="font-bold text-slate-700 text-sm flex items-center gap-2"><div class="w-2 h-2 bg-indigo-600 rounded-full"></div> Samify AI</h3>
                    <span class="text-[10px] bg-green-100 text-green-700 px-2 py-0.5 rounded-full font-bold">ONLINE</span>
                 </div>
                 <div class="flex-1 relative">
                     <zapier-interfaces-chatbot-embed is-popup='false' chatbot-id='cml9x572t0029ibz47krur5g7' height='100%' width='100%' class="absolute inset-0 w-full h-full"></zapier-interfaces-chatbot-embed>
                 </div>
            </div>
            <div class="h-[20%] bg-slate-900 text-white p-6 relative overflow-hidden flex flex-col justify-center">
                <div class="absolute top-0 right-0 w-32 h-32 bg-indigo-600 rounded-full blur-3xl opacity-20 -mr-10 -mt-10"></div>
                <div class="relative z-10">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-10px text-slate-400 uppercase font-bold tracking-widest">Netto Besparing (√Ör 1)</span>
                        <i class="fa-solid fa-calculator text-green-400"></i>
                    </div>
                    <div class="text-3xl font-extrabold tracking-tight text-white mb-1" id="right-roi-value">0 kr</div>
                    <div class="text-xs text-slate-400">med AutoFlow‚Ñ¢</div>
                </div>
            </div>
        </aside>

    </div>

    <!-- JAVASCRIPT -->
    <script>
        // --- SCRIPT DATA ---
        
        // Definition of specific Question Tracks
        const tracks = {
            A: { name: "Operativ / S√§ljchef", qs: [
                "1. Kan du beskriva resan f√∂r en kundorder fr√•n webshop till bokf√∂rt verifikat?",
                "2. Hur mycket tid l√§gger s√§ljteamet p√• admin j√§mf√∂rt med att st√§nga aff√§rer?",
                "4. Vilka uppgifter √§r s√• monotona att ni sk√§ms √∂ver att l√•ta en m√§nniska g√∂ra dem?",
                "5. Om din admin-person var sjuk i tv√• veckor, vad skulle stanna av helt?"
            ]},
            B: { name: "Ekonomi / CFO", qs: [
                "3. N√§r ni st√§nger i CRM:et, hur hamnar datan i ekonomisystemet idag?",
                "6. Hur m√•nga dagar tar ert m√•nadsbokslut och vad tar mest tid?",
                "7. Hur matchar ni inbetalningar p√• banken med ordernummer idag?",
                "8. Vad kostar det i tid/pengar n√§r en faktura blir fel p.g.a. m√§nskliga faktorn?"
            ]},
            C: { name: "Skalbarhet / Grundare", qs: [
                "11. Om ni dubblar volymen n√§sta kvartal, hur m√•nga nyanst√§llningar kr√§vs?",
                "14. Hur mycket 'Shadow IT' (egna Excel-l√∂sningar) har ni i organisationen?",
                "13. Vad hindrar er fr√•n att ta in 20% fler kunder med nuvarande personalstyrka?",
                "15. Hur planerar ni att anv√§nda AI f√∂r att vinna mot era konkurrenter?"
            ]},
            D: { name: "Service / Support", qs: [
                "16. I hur m√•nga system m√•ste personalen leta f√∂r att svara p√• en kundfr√•ga?",
                "19. Vilka √§r de 3 vanligaste fr√•gorna som egentligen √§r rena 'robot-svar'?",
                "17. Hur mycket tid l√§ggs p√• att manuellt skicka ut kollinummer?",
                "18. Hur skulle kundupplevelsen √§ndras om all historik fanns framme direkt?"
            ]}
        };

        // Pitches mapped to Tracks
        const pitches = {
            straight: { 
                title: "Raka & √Ñrliga", 
                text: "Hej [Namn], jag heter X fr√•n Samify. Jag ska vara helt √§rlig ‚Äì jag ringer f√∂r att boka ett m√∂te, men bara om ni har ett specifikt problem som vi l√∂ser √•t m√•nga i er bransch just nu.\n\nDet handlar om 'App-f√§llan' ‚Äì att man har bra system men tvingas flytta data manuellt mellan dem.\n\n√Ñr det n√•got ni brottas med, eller flyter allt automatiskt?\n\n(Inv√§nta bekr√§ftelse)...\n\nBara en snabb fr√•ga f√∂r att se om vi √§r relevanta: N√§r en order √§r st√§ngd hos er ‚Äì sker allt efterarbete per automatik, eller √§r det handp√•l√§ggning inblandad?",
                track: "A"
            },
            cfo: { 
                title: "CFO / Ekonomi", 
                text: "Hej [Namn], kort fr√•ga fr√•n Samify:\n\nN√§r ni st√§nger b√∂ckerna vid m√•nadsskiftet ‚Äì √§r det en smidig process, eller blir det mycket jagande av underlag och matchning av fakturor manuellt?",
                track: "B"
            },
            pain: { 
                title: "Sm√§rtan (Operativ)", 
                text: "Hej [Namn], jag ringer fr√•n Samify. Vi hj√§lper f√∂retag att ta bort de d√§r tr√•kiga, repetitiva arbetsuppgifterna som ingen egentligen vill g√∂ra.\n\nEn klassiker vi ser √§r att s√§ljare l√§gger mer tid p√• att knappa in ordrar i systemet √§n att faktiskt s√§lja. Hur ser den f√∂rdelningen ut hos er idag?",
                track: "A"
            },
            scale: { 
                title: "Skalbarhet", 
                text: "Hej [Namn], jag ser att ni v√§xer s√• det knakar! Grattis!\n\nAnledningen att jag ringer √§r att m√•nga i er fas uppt√§cker att administrationen v√§xer snabbare √§n int√§kterna.\n\nHar ni riggat era system f√∂r att hantera dubbla volymen n√§sta √•r utan att beh√∂va anst√§lla fler administrat√∂rer?",
                track: "C"
            },
            social: { 
                title: "Igenk√§nning", 
                text: "Hej [Namn], anledningen till att jag ringer √§r att vi jobbar med flera bolag som ocks√• k√∂r [Fortnox/Shopify].\n\nM√•nga av dem slet tidigare med att ordern kom in snyggt, men bokf√∂ringen sl√§pade efter och kr√§vde manuellt arbete.\n\nK√§nner du igen dig i den utmaningen, eller har ni l√∂st kopplingen helt?",
                track: "A"
            },
            curious: { 
                title: "Nyfikenhet", 
                text: "Hej [Namn], jag ringer fr√•n Samify och g√∂r lite research kring hur bolag i [Bransch] hanterar sina systemfl√∂den.\n\nM√•nga vi pratar med sitter i en sits d√§r systemen inte riktigt 'pratar med varandra'.\n\n√Ñr det en utmaning hos er ocks√•, eller har ni f√•tt ihop det?",
                track: "D"
            }
        };

        const objections = [
            { cat: "A", trig: "1. Zapier √§r amerikanskt. GDPR?", resp: "Jag f√∂rst√•r oron helt, det √§r en kritisk fr√•ga f√∂r alla svenska bolag idag. Det √§r viktigt att skilja p√• lagring och processering. Zapier har certifierat sig enligt Data Privacy Framework (DPF) och anv√§nder Standard Contractual Clauses (SCCs) vilket ger en laglig grund f√∂r √∂verf√∂ringen. Men f√∂r att vara extra s√§kra kan vi designa era fl√∂den med principen om dataminimering." },
            { cat: "A", trig: "2. Vi till√•ter inte tredjeparts√•tkomst", resp: "Det √§r en klok policy. Men paradoxalt nog √§r manuell datahantering ofta en st√∂rre s√§kerhetsrisk. N√§r vi integrerar via API anv√§nder vi 'Scoped Access' ‚Äì det inneb√§r att vi ger automationen en nyckel som bara kan g√∂ra exakt det den ska (t.ex. 'Skapa Faktura') och inget annat. Den kan inte l√§sa era l√∂ner eller se era bankkonton." },
            { cat: "B", trig: "6. Unika och komplexa processer", resp: "Det √§r faktiskt det b√§sta argumentet f√∂r automation. 'Unik' betyder ofta bara att den f√∂ljer specifika regler. Om ni kan skriva ner reglerna (t.ex. 'Om ordern √§r √∂ver 10 000 kr, mejla chefen'), s√• √§r det inte komplext f√∂r en dator ‚Äì det √§r bara logik." },
            { cat: "B", trig: "7. Testat sj√§lva, slutade fungera", resp: "DIY-automation √§r sk√∂rt. N√§r personen som byggde det slutar, eller n√§r ett API uppdateras, faller allt. Det √§r precis d√§rf√∂r Samify finns som en tj√§nst. Ni k√∂per inte bara bygget, ni k√∂per 'Drift'. Vi √∂vervakar fl√∂dena dygnet runt." },
            { cat: "C", trig: "11. Det √§r f√∂r dyrt (Har personal)", resp: "L√•t oss r√§kna p√• alternativkostnaden. Om din s√§ljadministrat√∂r l√§gger 2 timmar om dagen p√• att flytta data, √§r det ca 40 timmar i m√•naden. Med sociala avgifter och overhead kostar det er antagligen runt 20 000 - 30 000 kr i m√•naden i ren 'copy-paste'-tid." },
            { cat: "C", trig: "13. Vi kan g√∂ra det internt", resp: "Er IT-person √§r v√§rdefull. Vill ni att hen ska l√§gga 10 timmar i veckan p√• att fels√∂ka en webhook, eller ska hen fokusera p√• er k√§rnverksamhet? Intern automation blir ofta 'Shadow IT' ‚Äì o√∂vervakad och odokumenterad." }
        ];

        const arsenalQuestions = [
            { cat: "Operativ Tid", q: "1. Kan du beskriva resan f√∂r en kundorder fr√•n webshop till bokf√∂rt verifikat?" },
            { cat: "Operativ Tid", q: "2. Hur mycket tid l√§gger s√§ljteamet p√• admin j√§mf√∂rt med att st√§nga aff√§rer?" },
            { cat: "Ekonomi/CFO", q: "6. Hur m√•nga dagar tar ert m√•nadsbokslut och vad tar mest tid?" },
            { cat: "Ekonomi/CFO", q: "7. Hur matchar ni inbetalningar p√• banken med ordernummer idag?" },
            { cat: "Skalbarhet", q: "11. Om ni dubblar volymen n√§sta kvartal, hur m√•nga nyanst√§llningar kr√§vs?" },
            { cat: "Service/Support", q: "16. I hur m√•nga system m√•ste personalen leta f√∂r att svara p√• en kundfr√•ga?" }
        ];

        // --- SCRIPT LOGIC ---
        function startFlow(pitchKey) {
            const pitch = pitches[pitchKey];
            const track = tracks[pitch.track];

            document.getElementById('script-placeholder').classList.add('hidden');
            document.getElementById('script-content').classList.remove('hidden');

            // Set Phase 1
            document.getElementById('script-opener-text').innerText = pitch.text;

            // Set Phase 2 (Questions)
            document.getElementById('track-name').innerText = track.name;
            const qList = document.getElementById('script-questions-list');
            qList.innerHTML = "";
            track.qs.forEach(q => {
                qList.innerHTML += `<li class="flex items-start gap-3"><input type="checkbox" class="mt-1 w-4 h-4 accent-indigo-600"><span class="text-slate-700 font-medium">${q}</span></li>`;
            });

            // Reset Steps
            resetSteps();
            
            // Highlight active button
            document.querySelectorAll('.pitch-select-btn').forEach(b => {
                b.classList.remove('ring-2', 'ring-indigo-500', 'bg-indigo-50');
                if(b.onclick.toString().includes(`'${pitchKey}'`)) {
                    b.classList.add('ring-2', 'ring-indigo-500', 'bg-indigo-50');
                }
            });
        }

        function resetSteps() {
            document.getElementById('step-1').classList.add('active');
            document.getElementById('step-2').classList.remove('active', 'hidden');
            document.getElementById('step-2').classList.add('hidden');
            document.getElementById('step-3').classList.remove('active', 'hidden');
            document.getElementById('step-3').classList.add('hidden');
            document.getElementById('step-4').classList.remove('active', 'hidden');
            document.getElementById('step-4').classList.add('hidden');
            document.getElementById('quick-counters').classList.add('hidden');
        }

        function nextStep(stepNum) {
            const step = document.getElementById(`step-${stepNum}`);
            step.classList.remove('hidden');
            setTimeout(() => step.classList.add('active'), 10);
            step.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        function resetScript() {
            document.getElementById('script-content').classList.add('hidden');
            document.getElementById('script-placeholder').classList.remove('hidden');
            document.querySelectorAll('.pitch-select-btn').forEach(b => b.classList.remove('ring-2', 'ring-indigo-500', 'bg-indigo-50'));
        }

        // --- FORM LOGIC ---
        function initMultiStepForm() {
            const form = document.getElementById('customForm');
            if(!form) return;

            const steps = form.querySelectorAll('.form-step');
            const nextBtns = form.querySelectorAll('.btn-next');
            const prevBtns = form.querySelectorAll('.btn-prev');
            const progressBar = document.getElementById('progressBar');
            const stepCountSpan = document.getElementById('stepCount');
            const submitBtn = form.querySelector('.btn-submit');
            const formWrapper = document.getElementById('form-content-wrapper');
            const successMessage = document.getElementById('success-message');
            
            let currentStep = 0;

            function updateForm() {
                steps.forEach((step, index) => {
                    step.classList.toggle('active', index === currentStep);
                });
                
                if(steps.length > 0 && progressBar) {
                    const progress = ((currentStep + 1) / steps.length) * 100;
                    progressBar.style.width = progress + '%';
                }
                if(stepCountSpan) stepCountSpan.textContent = currentStep + 1;
                
                // Scroll to top of form
                document.getElementById('behovsanalys-container')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }

            nextBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const currentStepEl = steps[currentStep];
                    const inputs = currentStepEl.querySelectorAll('input, select, textarea');
                    let stepIsValid = true;
                    
                    for (const input of inputs) {
                        if (!input.checkValidity()) {
                            stepIsValid = false;
                            input.reportValidity();
                            break; 
                        }
                    }

                    if (stepIsValid && currentStep < steps.length - 1) {
                        currentStep++;
                        updateForm();
                    }
                });
            });

            prevBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    if (currentStep > 0) {
                        currentStep--;
                        updateForm();
                    }
                });
            });

            form.addEventListener('submit', async function(e) {
                e.preventDefault(); 
                const originalBtnText = submitBtn.innerText;
                submitBtn.innerText = "Skickar...";
                submitBtn.disabled = true;

                const formData = new FormData(form);
                const data = Object.fromEntries(formData.entries());
                
                try {
                    // Send to Zapier
                    const response = await fetch(form.action, {
                        method: 'POST',
                        body: JSON.stringify(data),
                    });

                    if (response.ok) {
                        if(formWrapper) formWrapper.style.display = 'none';
                        if(successMessage) successMessage.style.display = 'block';
                    } else {
                        alert("N√•got gick fel vid inskickningen. F√∂rs√∂k igen!");
                        submitBtn.innerText = originalBtnText;
                        submitBtn.disabled = false;
                    }
                } catch (error) {
                    alert("Ett n√§tverksfel uppstod. Kontrollera din anslutning.");
                    submitBtn.innerText = originalBtnText;
                    submitBtn.disabled = false;
                }
            });

            updateForm();
        }

        // --- COMMON LOGIC ---
        window.onload = () => {
            renderObjections();
            renderArsenal();
            calculateROI();
            initMultiStepForm();
        };

        function setPhase(phase) {
            document.querySelectorAll('.phase-btn').forEach(b => {
                b.classList.remove('active', 'bg-white', 'text-indigo-900', 'shadow-sm');
                b.classList.add('text-indigo-100', 'hover:bg-white/10');
            });
            document.getElementById('btn-' + phase).classList.add('active', 'bg-white', 'text-indigo-900', 'shadow-sm');
            document.getElementById('btn-' + phase).classList.remove('text-indigo-100', 'hover:bg-white/10');
            
            document.querySelectorAll('.phase-view').forEach(v => v.classList.add('hidden'));
            document.getElementById('view-' + phase).classList.remove('hidden');
        }

        function calculateROI() {
            const salary = parseInt(document.getElementById('roi-salary-level').value);
            const hoursPerDay = parseFloat(document.getElementById('roi-hours').value);
            const employeeCount = parseInt(document.getElementById('roi-employees').value) || 1; // New field
            
            const packageCost = 15000; // Simplified default for now, can be expanded
            const startFee = 7995;
            
            const hourlyCost = salary / 160; 
            const dailyCost = hourlyCost * hoursPerDay * employeeCount; // Multiply by employees
            const annualSavings = dailyCost * 21 * 11; 

            let softValue = 0;
            if(document.getElementById('roi-closing')?.checked) softValue += 20000; 
            if(document.getElementById('roi-scale')?.checked) softValue += 50000; 
            
            const totalGrossSavings = annualSavings + softValue;
            const netFirstYear = totalGrossSavings - ((packageCost * 12) + startFee);

            document.getElementById('roi-hours-display').innerText = hoursPerDay + " h/dag";
            
            const moneyStr = Math.round(netFirstYear).toLocaleString() + " kr";
            document.getElementById('res-money').innerText = moneyStr;
            document.getElementById('right-roi-value').innerText = moneyStr; 
        }

        function toggleLever(id) {
            const checkbox = document.getElementById(id);
            checkbox.checked = !checkbox.checked;
            checkbox.parentElement.classList.toggle('active', checkbox.checked);
            calculateROI();
        }

        function toggleObjection(idx) {
            const el = document.getElementById('ans-' + idx);
            const icon = document.getElementById('icon-' + idx);
            el.classList.toggle('open');
            icon.classList.toggle('rotate-180');
        }

        function renderObjections(filter = "") {
            const list = document.getElementById('objections-list');
            list.innerHTML = "";
            objections.filter(o => o.trig.toLowerCase().includes(filter.toLowerCase())).forEach((obj, idx) => {
                let badgeColor = obj.cat === "A" ? "bg-red-100 text-red-600" : (obj.cat === "B" ? "bg-blue-100 text-blue-600" : "bg-green-100 text-green-600");
                list.innerHTML += `
                    <div class="bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm hover:shadow-md transition group">
                        <button onclick="toggleObjection(${idx})" class="w-full text-left p-4 font-bold text-slate-700 hover:text-indigo-600 flex justify-between items-center gap-2">
                            <span class="flex items-center gap-2"><span class="text-[10px] font-bold px-2 py-0.5 rounded ${badgeColor}">KAT ${obj.cat}</span>${obj.trig}</span>
                            <i id="icon-${idx}" class="fa-solid fa-chevron-down text-xs text-slate-300 transition-transform duration-300"></i>
                        </button>
                        <div id="ans-${idx}" class="objection-content bg-slate-50"><p class="p-6 border-t border-slate-200 text-slate-600 leading-relaxed text-sm whitespace-pre-line">${obj.resp}</p></div>
                    </div>`;
            });
        }
        
        function renderArsenal() {
            const list = document.getElementById('arsenal-list');
            list.innerHTML = "";
            arsenalQuestions.forEach((item) => {
                let catColor = item.cat.includes("Ekonomi") ? "text-green-500" : "text-indigo-400";
                list.innerHTML += `<div class="bg-white p-4 rounded-lg border border-slate-100 shadow-sm text-sm"><span class="text-[10px] font-bold ${catColor} uppercase tracking-wider mb-1 block">${item.cat}</span><p class="text-slate-700 font-medium">"${item.q}"</p></div>`;
            });
        }
        document.getElementById('objSearch').addEventListener('input', (e) => renderObjections(e.target.value));
    </script>
</body>
</html>
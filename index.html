<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Samify Sales Dashboard V21 - New ROI</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- FontAwesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <!-- Zapier Chatbot Script -->
    <script async type='module' src='https://interfaces.zapier.com/assets/web-components/zapier-interfaces/zapier-interfaces.esm.js'></script>

    <!-- Montserrat Font (For ROI) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700;800&family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <style>
        * { font-family: 'Inter', sans-serif; }
        body { overflow: hidden; background-color: #f1f5f9; }

        /* Custom Scrollbar */
        .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #e2e8f0; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 3px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #64748b; }

        /* Animations */
        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Phase Button Active State */
        .phase-btn.active {
            background-color: white;
            color: #312e81; /* Indigo-900 */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transform: translateY(-1px);
        }

        /* Script Flow Styles */
        .script-block { border-left: 3px solid #cbd5e1; padding-left: 1.5rem; margin-bottom: 2rem; position: relative; opacity: 0.5; transition: all 0.3s ease; }
        .script-block.active { border-left-color: #4f46e5; opacity: 1; }
        .script-block::before { content: ''; position: absolute; left: -10px; top: 0; width: 17px; height: 17px; border-radius: 50%; background: #cbd5e1; border: 3px solid #fff; }
        .script-block.active::before { background: #4f46e5; }

        .pitch-btn-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 0.5rem; }

        /* Objection Accordion Logic */
        .objection-content { 
            max-height: 0; 
            overflow: hidden; 
            transition: max-height 0.4s ease-out, opacity 0.4s ease-out;
            opacity: 0;
        }
        .objection-content.open { 
            max-height: 500px; /* Safe max-height to allow content */
            opacity: 1;
        }
        .rotate-180 {
            transform: rotate(180deg);
        }

        /* Modal Styles */
        #tip-modal {
            background-color: rgba(15, 23, 42, 0.7); /* Slate-900 with opacity */
            backdrop-filter: blur(4px);
        }
        #tip-content {
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }

        /* Dashboard Styles */
        .dash-card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); margin-bottom: 20px; max-width: 500px; margin-left: auto; margin-right: auto; border: 1px solid #e2e8f0; }
        .dash-btn { display: flex; align-items: center; justify-content: center; gap: 8px; width: 100%; padding: 14px; margin: 8px 0; border: none; border-radius: 8px; font-size: 15px; font-weight: bold; cursor: pointer; color: white; transition: 0.2s; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .dash-btn:hover { transform: translateY(-1px); box-shadow: 0 4px 6px rgba(0,0,0,0.15); }
        .dash-btn:active { transform: scale(0.98); }
        .dash-btn-bra { background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); }
        .dash-btn-mellan { background: linear-gradient(135deg, #eab308 0%, #ca8a04 100%); color: white; }
        .dash-btn-dalig { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); }
        
        .dash-stat-box { background: #f8fafc; padding: 15px; border-radius: 12px; text-align: center; border: 1px solid #e2e8f0; }
        .dash-stat-value { font-size: 28px; font-weight: 800; color: #1e293b; line-height: 1; }
        .dash-stat-label { font-size: 11px; color: #64748b; text-transform: uppercase; font-weight: 600; letter-spacing: 0.5px; margin-top: 5px; }
        .dash-big-stat { background-color: #eff6ff; border: 1px solid #dbeafe; }
        .dash-big-stat .dash-stat-value { color: #2563eb; }

        /* Form Styles */
        #behovsanalys-container { background: #ffffff; color: #1e293b; position: relative; border-radius: 16px; box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1); padding: 40px; border: 1px solid #e2e8f0; }
        #behovsanalys-container .form-step { display: none; animation: fadeIn 0.4s ease-out; }
        #behovsanalys-container .form-step.active { display: block; }
        #behovsanalys-container h3 { margin-top: 0; color: #0f172a; font-size: 1.5rem; margin-bottom: 10px; font-weight: 700; }
        #behovsanalys-container p.step-desc { color: #64748b; margin-bottom: 25px; line-height: 1.5; font-size: 0.95rem; }
        #behovsanalys-container label { display: block; margin-bottom: 6px; font-weight: 600; font-size: 0.9rem; color: #334155; }
        #behovsanalys-container input[type="text"], #behovsanalys-container input[type="email"], #behovsanalys-container input[type="tel"], #behovsanalys-container textarea, #behovsanalys-container select { width: 100%; padding: 12px 16px; margin-bottom: 20px; border: 1px solid #cbd5e1; border-radius: 8px; box-sizing: border-box; font-size: 14px; background: #f8fafc; transition: border 0.2s, box-shadow 0.2s; }
        #behovsanalys-container input:focus, #behovsanalys-container textarea:focus, #behovsanalys-container select:focus { border-color: #2563eb; background: #fff; outline: none; box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1); }
        #behovsanalys-container .radio-group { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        #behovsanalys-container .radio-card { position: relative; }
        #behovsanalys-container .radio-card input { opacity: 0; position: absolute; width: 0; }
        #behovsanalys-container .radio-card label { display: block; padding: 12px; border: 1px solid #cbd5e1; border-radius: 8px; text-align: center; cursor: pointer; background: #fff; transition: all 0.2s; font-weight: 500; margin: 0; font-size: 14px; }
        #behovsanalys-container .radio-card input:checked + label { border-color: #2563eb; background-color: #eff6ff; color: #2563eb; font-weight: 700; }
        #behovsanalys-container .btn-group { display: flex; justify-content: space-between; margin-top: 30px; padding-top: 20px; border-top: 1px solid #f1f5f9; }
        #behovsanalys-container button.form-btn { padding: 12px 28px; border: none; border-radius: 50px; cursor: pointer; font-size: 14px; font-weight: 600; transition: transform 0.2s, background 0.2s; }
        #behovsanalys-container .btn-next, #behovsanalys-container .btn-submit { background: linear-gradient(90deg, #2563eb 0%, #1d4ed8 100%); color: white; box-shadow: 0 4px 12px rgba(37, 99, 235, 0.2); }
        #behovsanalys-container .btn-prev { background-color: white; color: #64748b; border: 1px solid #cbd5e1; }
        #behovsanalys-container .btn-next:hover, #behovsanalys-container .btn-submit:hover { transform: translateY(-1px); box-shadow: 0 6px 15px rgba(37, 99, 235, 0.3); }
        #behovsanalys-container .progress-wrapper { margin-bottom: 30px; }
        #behovsanalys-container .progress-bg { background-color: #f1f5f9; height: 6px; border-radius: 3px; overflow: hidden; }
        #behovsanalys-container .progress-bar { background-color: #2563eb; height: 100%; width: 0%; transition: width 0.4s ease; }
        #behovsanalys-container .step-indicator { text-align: right; font-size: 0.75rem; color: #94a3b8; margin-top: 5px; font-weight: 600; }
        #success-message { text-align: center; display: none; padding: 20px; }
        #success-message h3 { color: #22c55e; font-size: 2rem; margin-bottom: 10px; }
        #success-message p { color: #475569; font-size: 1.1rem; }

        /* --- NEW ROI CALCULATOR STYLES --- */
        .calculator-wrapper {
            --primary: #1e293b;       /* Slate 800 - Premium Dark */
            --accent: #2563eb;        /* Brand Blue */
            --accent-hover: #1d4ed8;
            --highlight: #a855f7;     /* Samify Purple Dot */
            --success: #10b981;       /* Green for positive numbers */
            --bg-color: #f8fafc;
            --card-bg: #ffffff;
            --text-main: #334155;
            --text-light: #64748b;
            --border: #e2e8f0;
        }

        /* Reset f√∂r box-sizing inom modulen */
        .calculator-wrapper * { box-sizing: border-box; }

        /* --- CONTAINER --- */
        .calculator-wrapper {
            font-family: 'Montserrat', sans-serif;
            color: var(--text-main);
            background: var(--card-bg);
            width: 100%;
            max-width: 900px;
            margin: 20px auto; /* Centrerar modulen */
            border-radius: 24px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--border);
            overflow: hidden;
            text-align: left; /* S√§kerst√§ll v√§nsterst√§lld text */
        }

        /* --- HEADER --- */
        .calculator-wrapper .header {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            padding: 40px;
            text-align: center;
            color: white;
            position: relative;
        }

        .calculator-wrapper .logo {
            font-size: 2.5rem;
            font-weight: 800;
            letter-spacing: -1px;
            margin-bottom: 10px;
            display: inline-block;
            color: white;
        }
        
        .calculator-wrapper .logo span { color: var(--highlight); }

        .calculator-wrapper .header p {
            color: #94a3b8;
            font-size: 1.1rem;
            margin: 0;
            font-weight: 400;
        }

        .calculator-wrapper .badge {
            display: inline-block;
            background: rgba(255,255,255,0.1);
            padding: 6px 12px;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-top: 15px;
            color: #cbd5e1;
            border: 1px solid rgba(255,255,255,0.1);
        }

        /* --- BODY CONTENT --- */
        .calculator-wrapper .content { padding: 40px; }

        /* --- SECTIONS --- */
        .calculator-wrapper .section-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .calculator-wrapper .section-number {
            background: var(--accent);
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .calculator-wrapper .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }

        /* --- INPUTS --- */
        .calculator-wrapper label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 0.95rem;
            color: var(--text-main);
        }
        
        .calculator-wrapper .helper-text {
            font-size: 0.8rem;
            color: var(--text-light);
            margin-bottom: 10px;
            display: block;
            line-height: 1.4;
        }

        .calculator-wrapper select, 
        .calculator-wrapper input[type="number"] {
            width: 100%;
            padding: 14px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-family: 'Montserrat', sans-serif;
            font-size: 1rem;
            transition: all 0.2s;
            background: #fcfcfc;
            color: var(--text-main);
        }

        .calculator-wrapper select:focus, 
        .calculator-wrapper input[type="number"]:focus {
            outline: none;
            border-color: var(--accent);
            background: white;
            box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.1);
        }

        /* --- TOGGLE TABS (Simple vs Advanced) --- */
        .calculator-wrapper .tabs {
            display: flex;
            background: #f1f5f9;
            padding: 5px;
            border-radius: 12px;
            margin-bottom: 20px;
        }
        .calculator-wrapper .tab-btn {
            flex: 1;
            padding: 12px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            color: var(--text-light);
            border-radius: 8px;
            transition: all 0.2s;
        }
        .calculator-wrapper .tab-btn.active {
            background: white;
            color: var(--accent);
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
        }

        /* --- SLIDERS --- */
        .calculator-wrapper .slider-wrapper { margin-bottom: 10px; }
        .calculator-wrapper .slider-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-bottom: 10px;
        }
        .calculator-wrapper .slider-val {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--accent);
        }
        .calculator-wrapper input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            background: #e2e8f0;
            border-radius: 10px;
            outline: none;
            border: none;
            padding: 0;
            margin: 0;
        }
        .calculator-wrapper input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--accent);
            cursor: pointer;
            border: 3px solid white;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.1s;
        }
        .calculator-wrapper input[type=range]::-webkit-slider-thumb:hover { transform: scale(1.1); }

        /* --- CHECKBOX CARDS (Levers) --- */
        .calculator-wrapper .levers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        .calculator-wrapper .lever-card {
            background: white;
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        .calculator-wrapper .lever-card:hover { border-color: #cbd5e1; }
        .calculator-wrapper .lever-card.active {
            border-color: var(--accent);
            background: #eff6ff;
        }
        .calculator-wrapper .lever-card input {
            margin-top: 4px;
            accent-color: var(--accent);
            transform: scale(1.2);
            cursor: pointer;
        }
        .calculator-wrapper .lever-title { display: block; font-weight: 700; font-size: 0.9rem; color: var(--primary); }
        .calculator-wrapper .lever-desc { display: block; font-size: 0.8rem; color: var(--text-light); margin-top: 2px; }

        /* --- RESULTS AREA --- */
        .calculator-wrapper .results-section {
            background: #f8fafc;
            border-top: 2px dashed var(--border);
            padding-top: 40px;
            margin-top: 20px;
        }

        .calculator-wrapper .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .calculator-wrapper .result-box {
            background: white;
            padding: 25px;
            border-radius: 16px;
            border: 1px solid var(--border);
            text-align: center;
        }

        .calculator-wrapper .result-box.samify {
            background: linear-gradient(135deg, var(--primary) 0%, #0f172a 100%);
            color: white;
            border: none;
            position: relative;
            overflow: hidden;
            grid-column: span 2; /* Full width */
        }
        
        /* Background decoration for Samify card */
        .calculator-wrapper .result-box.samify::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(168, 85, 247, 0.4) 0%, rgba(255,255,255,0) 70%);
            border-radius: 50%;
        }

        .calculator-wrapper .res-label {
            text-transform: uppercase;
            font-size: 0.8rem;
            letter-spacing: 1px;
            font-weight: 700;
            margin-bottom: 10px;
            display: block;
            opacity: 0.8;
        }
        
        .calculator-wrapper .res-value {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 5px;
            display: block;
        }
        
        .calculator-wrapper .res-sub { font-size: 0.85rem; opacity: 0.7; }

        /* --- RESPONSIVE --- */
        @media (max-width: 700px) {
            .calculator-wrapper .grid-2 { grid-template-columns: 1fr; }
            .calculator-wrapper .header { padding: 30px 20px; }
            .calculator-wrapper .content { padding: 25px; }
            .calculator-wrapper .logo { font-size: 2rem; }
            .calculator-wrapper .comparison-grid { grid-template-columns: 1fr; }
            .calculator-wrapper .result-box.samify { grid-column: span 1; }
        }

        .hidden { display: none; }
    </style>
</head>
<body class="h-screen flex flex-col text-slate-800">

    <!-- HEADER -->
    <header class="bg-gradient-to-r from-slate-900 via-indigo-900 to-slate-900 text-white px-6 py-3 shadow-lg shrink-0 z-30 h-16 flex items-center justify-between">
        <div class="flex items-center gap-3">
            <div class="bg-white/10 p-2 rounded-lg backdrop-blur-sm border border-white/10">
                <i class="fa-solid fa-bolt text-yellow-400"></i>
            </div>
            <div>
                <h1 class="font-bold text-lg tracking-tight leading-none">Samify <span class="font-light opacity-70">OS</span></h1>
                <div class="flex items-center gap-2 text-[10px] text-indigo-200 mt-1">
                    <span class="w-1.5 h-1.5 bg-green-400 rounded-full animate-pulse"></span>
                    Sales Playbook V21
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="flex gap-2 bg-black/20 p-1 rounded-xl border border-white/5">
            <!-- 1. Dashboard -->
            <button onclick="setPhase('dashboard')" id="btn-dashboard" class="phase-btn active px-4 py-1.5 rounded-lg text-sm font-semibold transition-all flex items-center gap-2">
                <i class="fa-solid fa-chart-line"></i> 1. Dashboard
            </button>
            <!-- 2. S√§ljmanus -->
            <button onclick="setPhase('presentation')" id="btn-presentation" class="phase-btn px-4 py-1.5 rounded-lg text-sm font-semibold transition-all flex items-center gap-2 text-indigo-100 hover:bg-white/10">
                <i class="fa-solid fa-microphone-lines"></i> 2. S√§ljmanus
            </button>
            <!-- 3. Hantera -->
            <button onclick="setPhase('objection')" id="btn-objection" class="phase-btn px-4 py-1.5 rounded-lg text-sm font-semibold transition-all flex items-center gap-2 text-indigo-100 hover:bg-white/10">
                <i class="fa-solid fa-shield-halved"></i> 3. Hantera
            </button>
            <!-- 4. St√§ng -->
            <button onclick="setPhase('closing')" id="btn-closing" class="phase-btn px-4 py-1.5 rounded-lg text-sm font-semibold transition-all flex items-center gap-2 text-indigo-100 hover:bg-white/10">
                <i class="fa-solid fa-check"></i> 4. St√§ng
            </button>
            
            <div class="h-6 w-px bg-white/10 mx-1 self-center"></div>
            
            <!-- Extra: ROI -->
            <button onclick="setPhase('roi')" id="btn-roi" class="phase-btn px-4 py-1.5 rounded-lg text-sm font-semibold transition-all flex items-center gap-2 text-indigo-100 hover:bg-white/10">
                <i class="fa-solid fa-calculator"></i> ROI
            </button>
            <!-- Extra: Behovsanalys -->
            <button onclick="setPhase('analysis')" id="btn-analysis" class="phase-btn px-4 py-1.5 rounded-lg text-sm font-semibold transition-all flex items-center gap-2 text-indigo-100 hover:bg-white/10">
                <i class="fa-solid fa-magnifying-glass"></i> Behovsanalys
            </button>
        </div>

        <div class="flex gap-3">
            <button class="w-8 h-8 rounded-full bg-white/10 hover:bg-white/20 flex items-center justify-center transition">
                <i class="fa-solid fa-user text-sm"></i>
            </button>
        </div>
    </header>

    <!-- MAIN CONTAINER -->
    <div class="flex-1 flex overflow-hidden min-h-0 bg-slate-100">

        <!-- COLUMN 1: ARBETSYTA (75%) -->
        <main class="w-3/4 flex flex-col border-r border-slate-200 relative overflow-hidden bg-white">
            
            <!-- VIEW 1: DASHBOARD -->
            <div id="view-dashboard" class="phase-view h-full flex flex-col overflow-y-auto custom-scrollbar p-8 bg-slate-50">
                <div class="max-w-2xl mx-auto w-full">
                    <h2 class="text-2xl font-bold text-slate-800 mb-6 text-center">üìû S√§ljpanel & Statistik</h2>
                    <!-- User Selector -->
                    <div class="dash-card">
                        <h3 class="text-sm font-bold text-slate-500 uppercase mb-3 tracking-wider">Vem loggar?</h3>
                        <select id="currentUser" class="w-full p-3 border-2 border-indigo-200 rounded-lg text-base font-bold text-indigo-900 bg-indigo-50 focus:border-indigo-500 focus:outline-none transition">
                            <option value="" disabled selected>V√§lj ditt namn...</option>
                            <option value="Adrian K√•lback">Adrian K√•lback</option>
                            <option value="Emil M√§ssing">Emil M√§ssing</option>
                            <option value="Lawand Nasro">Lawand Nasro</option>
                            <option value="Malin Karlsson">Malin Karlsson</option>
                        </select>
                    </div>
                    <!-- Call Logger -->
                    <div class="dash-card">
                        <h3 class="text-sm font-bold text-slate-500 uppercase mb-3 tracking-wider">Logga Nytt Samtal</h3>
                        <input type="text" id="foretagInput" class="w-full p-3 border border-slate-300 rounded-lg text-base mb-4 focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none" placeholder="F√∂retagets namn..." autofocus>
                        <div class="space-y-2">
                            <button class="dash-btn dash-btn-bra" onclick="logga('Bra')"><i class="fa-solid fa-check"></i> ‚úÖ Bra (S√§lj/Boka)</button>
                            <button class="dash-btn dash-btn-mellan" onclick="logga('Mellan')"><i class="fa-solid fa-question"></i> ü§î Mellan</button>
                            <button class="dash-btn dash-btn-dalig" onclick="logga('D√•ligt')"><i class="fa-solid fa-xmark"></i> ‚ùå D√•ligt / Inget svar</button>
                        </div>
                        <div id="error-box" class="hidden mt-3 bg-red-100 text-red-700 p-3 rounded-lg text-sm border border-red-200"></div>
                    </div>
                    <!-- Statistics -->
                    <div class="dash-card">
                        <h3 class="text-sm font-bold text-slate-500 uppercase mb-4 tracking-wider flex items-center gap-2"><i class="fa-solid fa-chart-pie text-indigo-500"></i> Min Session (Just nu)</h3>
                        <div class="grid grid-cols-2 gap-3">
                            <div class="dash-stat-box">
                                <div id="count-total" class="dash-stat-value">0</div>
                                <div class="dash-stat-label">Samtal</div>
                            </div>
                            <div class="dash-stat-box">
                                <div id="count-bra" class="dash-stat-value">0</div>
                                <div class="dash-stat-label">Antal "Bra"</div>
                            </div>
                            <div class="dash-stat-box dash-big-stat col-span-2">
                                <div id="hitrate" class="dash-stat-value">-</div>
                                <div class="dash-stat-label">Samtal per JA</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 2: S√ÑLJMANUS -->
            <div id="view-presentation" class="phase-view hidden h-full flex flex-col relative">
                <div class="border-b border-slate-200 px-8 py-4 shrink-0 bg-white shadow-sm flex justify-between items-center">
                    <h2 class="font-bold text-slate-800 flex items-center gap-2">
                        <span class="bg-indigo-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-xs">2</span>
                        V√§lj Inledning f√∂r att starta fl√∂det
                    </h2>
                    <div class="flex gap-4 items-center">
                        <button onclick="showDailyTip()" class="text-xs text-indigo-600 font-bold hover:text-indigo-800 bg-indigo-50 px-3 py-1.5 rounded-lg border border-indigo-100 transition">üí° Dagens Tips</button>
                        <button onclick="resetScript()" class="text-xs text-slate-400 hover:text-slate-600"><i class="fa-solid fa-rotate-right"></i> √Öterst√§ll</button>
                    </div>
                </div>
                
                <div class="flex-1 flex overflow-hidden">
                    <!-- LEFT: PITCH SELECTION -->
                    <div class="w-1/3 bg-slate-50 border-r border-slate-200 overflow-y-auto custom-scrollbar p-6">
                        <p class="text-xs font-bold text-slate-400 uppercase mb-4 tracking-wider">V√§lj Scenario</p>
                        <div class="space-y-3">
                            <button onclick="startFlow('straight')" class="pitch-select-btn w-full text-left p-4 bg-white border border-slate-200 rounded-xl shadow-sm hover:border-indigo-400 hover:shadow-md transition group">
                                <div class="flex items-center gap-3">
                                    <span class="text-2xl group-hover:scale-110 transition">üéØ</span>
                                    <div>
                                        <span class="block font-bold text-slate-700 text-sm">Raka & √Ñrliga</span>
                                        <span class="text-[10px] text-slate-500">Stressade chefer / VD</span>
                                    </div>
                                </div>
                            </button>
                            <button onclick="startFlow('cfo')" class="pitch-select-btn w-full text-left p-4 bg-white border border-slate-200 rounded-xl shadow-sm hover:border-indigo-400 hover:shadow-md transition group">
                                <div class="flex items-center gap-3">
                                    <span class="text-2xl group-hover:scale-110 transition">üí∞</span>
                                    <div>
                                        <span class="block font-bold text-slate-700 text-sm">CFO / Ekonomi</span>
                                        <span class="text-[10px] text-slate-500">Fokus l√∂nsamhet & bokslut</span>
                                    </div>
                                </div>
                            </button>
                            <button onclick="startFlow('pain')" class="pitch-select-btn w-full text-left p-4 bg-white border border-slate-200 rounded-xl shadow-sm hover:border-indigo-400 hover:shadow-md transition group">
                                <div class="flex items-center gap-3">
                                    <span class="text-2xl group-hover:scale-110 transition">ü§ï</span>
                                    <div>
                                        <span class="block font-bold text-slate-700 text-sm">Sm√§rtan (Operativ)</span>
                                        <span class="text-[10px] text-slate-500">S√§ljchefer / Admin</span>
                                    </div>
                                </div>
                            </button>
                            <button onclick="startFlow('scale')" class="pitch-select-btn w-full text-left p-4 bg-white border border-slate-200 rounded-xl shadow-sm hover:border-indigo-400 hover:shadow-md transition group">
                                <div class="flex items-center gap-3">
                                    <span class="text-2xl group-hover:scale-110 transition">üìà</span>
                                    <div>
                                        <span class="block font-bold text-slate-700 text-sm">Skalbarhet</span>
                                        <span class="text-[10px] text-slate-500">Gaseller / Startups</span>
                                    </div>
                                </div>
                            </button>
                             <button onclick="startFlow('social')" class="pitch-select-btn w-full text-left p-4 bg-white border border-slate-200 rounded-xl shadow-sm hover:border-indigo-400 hover:shadow-md transition group">
                                <div class="flex items-center gap-3">
                                    <span class="text-2xl group-hover:scale-110 transition">ü§ù</span>
                                    <div>
                                        <span class="block font-bold text-slate-700 text-sm">Igenk√§nning</span>
                                        <span class="text-[10px] text-slate-500">Vet system (Fortnox/Shopify)</span>
                                    </div>
                                </div>
                            </button>
                            <button onclick="startFlow('curious')" class="pitch-select-btn w-full text-left p-4 bg-white border border-slate-200 rounded-xl shadow-sm hover:border-indigo-400 hover:shadow-md transition group">
                                <div class="flex items-center gap-3">
                                    <span class="text-2xl group-hover:scale-110 transition">ü§î</span>
                                    <div>
                                        <span class="block font-bold text-slate-700 text-sm">Nyfikenhet</span>
                                        <span class="text-[10px] text-slate-500">Mjuk √∂ppning</span>
                                    </div>
                                </div>
                            </button>
                            <button onclick="startFlow('provoke')" class="pitch-select-btn w-full text-left p-4 bg-white border border-slate-200 rounded-xl shadow-sm hover:border-indigo-400 hover:shadow-md transition group">
                                <div class="flex items-center gap-3">
                                    <span class="text-2xl group-hover:scale-110 transition">üå∂Ô∏è</span>
                                    <div>
                                        <span class="block font-bold text-slate-700 text-sm">Provocerande</span>
                                        <span class="text-[10px] text-slate-500">V√•ga sticka ut</span>
                                    </div>
                                </div>
                            </button>
                        </div>
                    </div>

                    <!-- RIGHT: INTERACTIVE SCRIPT FLOW -->
                    <div class="w-2/3 bg-white p-8 overflow-y-auto custom-scrollbar relative" id="script-container">
                        <div id="script-placeholder" class="h-full flex flex-col items-center justify-center text-slate-400 opacity-60">
                            <i class="fa-solid fa-arrow-left text-4xl mb-4"></i>
                            <p>V√§lj en inledning till v√§nster</p>
                        </div>
                        <div id="script-content" class="hidden max-w-2xl mx-auto pb-20">
                            <div id="step-1" class="script-block active">
                                <h4 class="text-xs font-bold text-green-600 uppercase mb-2 tracking-wider">üü¢ Fas 1: √ñppning & Hook</h4>
                                <div class="bg-green-50 p-6 rounded-2xl border border-green-100 shadow-sm mb-4">
                                    <p class="text-lg text-slate-800 font-medium whitespace-pre-line leading-relaxed" id="script-opener-text">...</p>
                                </div>
                                <button onclick="nextStep(2)" class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg font-bold text-sm shadow-md transition transform hover:scale-105">
                                    Kund bekr√§ftar - G√• vidare <i class="fa-solid fa-arrow-down ml-2"></i>
                                </button>
                            </div>
                            <div id="step-2" class="script-block hidden">
                                <h4 class="text-xs font-bold text-indigo-600 uppercase mb-2 tracking-wider">üü° Fas 2: Behovsanalys (<span id="track-name">SP√ÖR X</span>)</h4>
                                <div class="bg-indigo-50 p-6 rounded-2xl border border-indigo-100 shadow-sm mb-4">
                                    <p class="text-sm text-indigo-800 font-bold mb-4 border-b border-indigo-200 pb-2">St√§ll dessa fr√•gor:</p>
                                    <ul class="space-y-4" id="script-questions-list"></ul>
                                </div>
                                <button onclick="nextStep(3)" class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg font-bold text-sm shadow-md transition transform hover:scale-105">
                                    F√•tt svar - G√• till Diagnos <i class="fa-solid fa-arrow-down ml-2"></i>
                                </button>
                            </div>
                            <div id="step-3" class="script-block hidden">
                                <h4 class="text-xs font-bold text-orange-500 uppercase mb-2 tracking-wider">üü† Fas 3: Diagnos & Pitch</h4>
                                <div class="bg-orange-50 p-6 rounded-2xl border border-orange-100 shadow-sm mb-4">
                                    <p class="text-base text-slate-700 italic leading-relaxed">
                                        "Tack f√∂r att du delar med dig. Baserat p√• det du s√§ger ‚Äì att ni l√§gger tid p√• <strong>[N√§mn problem]</strong> och vill undvika <strong>[N√§mn risk]</strong>... s√• √§r ni ett skolboksexempel p√• varf√∂r vi finns.<br><br>
                                        Vi s√§ljer inte ett nytt IT-system. Vi fungerar som en <strong>'Automation as a Service'</strong>. Vi kopplar ihop era befintliga system s√• att datan flyter automatiskt.<br><br>
                                        T√§nk dig att den d√§r ordern bokf√∂rs direkt, eller att s√§ljaren slipper admin-arbetet helt. Vi garanterar driften s√• ni slipper oroa er f√∂r teknikstrul."
                                    </p>
                                </div>
                                <button onclick="nextStep(4)" class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg font-bold text-sm shadow-md transition transform hover:scale-105">
                                    G√• p√• Avslut <i class="fa-solid fa-arrow-down ml-2"></i>
                                </button>
                            </div>
                            <div id="step-4" class="script-block hidden">
                                <h4 class="text-xs font-bold text-red-500 uppercase mb-2 tracking-wider">üî¥ Fas 4: Boka M√∂tet</h4>
                                <div class="bg-red-50 p-6 rounded-2xl border border-red-100 shadow-sm mb-4">
                                    <p class="text-lg text-slate-800 font-bold leading-relaxed">
                                        "Jag varken kan eller vill l√∂sa hela er struktur p√• telefon. Men min kollega Adnan √§r specialist p√• just [Deras System].<br><br>
                                        Vi brukar ta en 15-minuters demo d√§r vi visar exakt hur vi l√∂st [Deras Problem] f√∂r andra bolag i er bransch.<br><br>
                                        Om vi kan visa ett s√§tt att spara de d√§r timmarna vi pratade om ‚Äì har du m√∂jlighet <span class="text-red-600 bg-red-100 px-1">tisdag f√∂rmiddag eller torsdag eftermiddag</span> f√∂r att kika p√• det?"
                                    </p>
                                </div>
                                <div class="flex gap-3">
                                    <button onclick="setPhase('closing')" class="bg-green-600 hover:bg-green-700 text-white px-8 py-3 rounded-xl font-bold text-sm shadow-lg transition transform hover:scale-105 flex items-center gap-2">
                                        <i class="fa-solid fa-calendar-check"></i> Ja - Boka nu
                                    </button>
                                    <button onclick="document.getElementById('quick-counters').classList.remove('hidden')" class="bg-white border border-slate-300 text-slate-600 px-4 py-3 rounded-xl font-bold text-sm hover:bg-slate-50">
                                        Fick nej? (Inv√§ndning)
                                    </button>
                                </div>
                                <div id="quick-counters" class="hidden mt-6 pt-6 border-t border-slate-200 grid grid-cols-1 gap-2 animate-[fadeIn_0.3s_ease-out]">
                                    <div class="text-xs font-bold text-slate-400 uppercase mb-2">R√§ddningsplankor</div>
                                    <div class="bg-slate-50 p-3 rounded-lg text-sm border border-slate-200">
                                        <strong class="text-slate-800">"Har IT-kille/G√∂r sj√§lva"</strong><br>
                                        <span class="text-slate-600 italic">"Kanon! Men vill ni att han ska l√§gga tid p√• att underh√•lla kopplingar eller bygga v√§rde? Vi sk√∂ter driften (Ops) s√• ni slipper avbrott."</span>
                                    </div>
                                    <div class="bg-slate-50 p-3 rounded-lg text-sm border border-slate-200">
                                        <strong class="text-slate-800">"F√∂r dyrt"</strong><br>
                                        <span class="text-slate-600 italic">"J√§mf√∂rt med m√§nskliga fel eller en nyanst√§llning √§r detta en br√•kdel. L√•t oss r√§kna p√• ROI i m√∂tet."</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- DAILY TIP MODAL -->
                <div id="tip-modal" class="hidden absolute inset-0 z-50 flex items-center justify-center p-4">
                    <div id="tip-content" class="bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden border border-slate-200">
                        <div class="bg-gradient-to-r from-indigo-600 to-blue-500 p-6 text-white flex justify-between items-start">
                            <div>
                                <h3 class="text-xl font-bold flex items-center gap-2"><i class="fa-solid fa-sun text-yellow-300"></i> Morgonpeppen</h3>
                                <p class="text-indigo-100 text-sm mt-1">5 Nycklar f√∂r Dagen</p>
                            </div>
                            <button onclick="closeTip()" class="text-white/70 hover:text-white text-xl">&times;</button>
                        </div>
                        <div class="p-6 max-h-[70vh] overflow-y-auto custom-scrollbar">
                            <div class="space-y-4">
                                <!-- Static 1 -->
                                <div class="flex gap-4">
                                    <div class="bg-indigo-50 text-indigo-600 w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm shrink-0">1</div>
                                    <div>
                                        <h4 class="font-bold text-slate-800 text-sm">Var en kameleont (Agil & Kreativ)</h4>
                                        <p class="text-xs text-slate-600 mt-1">Du √§r inte en robot. Plocka guldkornen fr√•n pitcharna och g√∂r dem till dina egna. S√•lla bort det on√∂diga.</p>
                                    </div>
                                </div>
                                <!-- Static 2 -->
                                <div class="flex gap-4">
                                    <div class="bg-indigo-50 text-indigo-600 w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm shrink-0">2</div>
                                    <div>
                                        <h4 class="font-bold text-slate-800 text-sm">Hitta r√§tt frekvens (Energi)</h4>
                                        <p class="text-xs text-slate-600 mt-1">Stressad kund? Var lugn (No Bullshit). Nyfiken kund? H√∂j energin (Skalbarhet). Matcha tonl√§get.</p>
                                    </div>
                                </div>
                                <!-- Static 3 -->
                                <div class="flex gap-4">
                                    <div class="bg-indigo-50 text-indigo-600 w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm shrink-0">3</div>
                                    <div>
                                        <h4 class="font-bold text-slate-800 text-sm">Tro p√• det du s√§ljer (√ñvertygelse)</h4>
                                        <p class="text-xs text-slate-600 mt-1">Vi l√∂ser faktiska problem (Admin-kaos). Du s√§ljer inte en produkt, du s√§ljer en l√∂sning p√• deras sm√§rta.</p>
                                    </div>
                                </div>
                                <!-- Dynamic 4 -->
                                <div class="flex gap-4">
                                    <div class="bg-green-50 text-green-600 w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm shrink-0">4</div>
                                    <div id="dynamic-tip-4"></div>
                                </div>
                                <!-- Dynamic 5 -->
                                <div class="flex gap-4">
                                    <div class="bg-green-50 text-green-600 w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm shrink-0">5</div>
                                    <div id="dynamic-tip-5"></div>
                                </div>
                            </div>
                        </div>
                        <div class="bg-slate-50 p-4 text-center border-t border-slate-100">
                            <button onclick="closeTip()" class="bg-indigo-600 text-white px-6 py-2 rounded-lg font-bold text-sm hover:bg-indigo-700 transition">Nu k√∂r vi! üöÄ</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW 3: HANTERA -->
            <div id="view-objection" class="phase-view hidden h-full flex flex-col p-8 overflow-y-auto custom-scrollbar">
                <div class="flex gap-8 h-full">
                    <div class="w-1/2 flex flex-col">
                        <h3 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2"><i class="fa-solid fa-shield-halved text-indigo-500"></i> Inv√§ndningar (Motst√•nd)</h3>
                        <div class="relative mb-4">
                            <i class="fa-solid fa-search absolute left-4 top-3.5 text-slate-400"></i>
                            <input type="text" id="objSearch" placeholder="S√∂k motargument..." class="w-full pl-10 pr-4 py-3 rounded-lg border border-slate-200 shadow-sm outline-none transition focus:border-indigo-500 text-sm">
                        </div>
                        <div id="objections-list" class="flex-1 overflow-y-auto custom-scrollbar space-y-3 pr-2"></div>
                    </div>
                    <div class="w-1/2 flex flex-col">
                        <h3 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2"><i class="fa-solid fa-clipboard-question text-green-500"></i> Arsenalen (20 Fr√•gor)</h3>
                        <div id="arsenal-list" class="flex-1 overflow-y-auto custom-scrollbar space-y-4 pr-2"></div>
                    </div>
                </div>
            </div>

            <!-- VIEW 4: ST√ÑNG -->
            <div id="view-closing" class="phase-view hidden h-full flex flex-col p-8 overflow-y-auto custom-scrollbar items-center">
                <h3 class="text-2xl font-bold text-slate-700 mb-6">Boka in kunden</h3>
                <div class="calendly-inline-widget" data-url="https://calendly.com/samify-info/30min" style="min-width:320px;height:700px;width:100%;"></div>
                <script type="text/javascript" src="https://assets.calendly.com/assets/external/widget.js" async></script>
            </div>

            <!-- VIEW: ROI (NEW - FIXED SCROLLING) -->
            <!-- Changed 'flex flex-col' to 'block' and added 'pb-32' -->
            <div id="view-roi" class="phase-view hidden h-full block overflow-y-auto custom-scrollbar p-4 pb-32 bg-slate-50">
                <div id="roi-kalkylator" class="calculator-wrapper">
                    <!-- Header -->
                    <div class="header">
                        <div class="logo">Samify<span>.</span></div>
                        <p>Aff√§rskalkylator & Potentialanalys</p>
                        <div class="badge">Baserat p√• SCB (2024) + Alternativkostnad</div>
                    </div>
                    <div class="content">
                        <!-- 1. ROLL & PERSONAL -->
                        <div class="section-title">
                            <div class="section-number">1</div>
                            Vem och hur m√•nga avlastar vi?
                        </div>
                        <div class="grid-2">
                            <div>
                                <label for="role-select">Vilken roll?</label>
                                <div class="helper-text">L√∂neniv√•n p√•verkar kostnaden f√∂r ineffektivitet.</div>
                                <select id="role-select" onchange="calculate()">
                                    <option value="32000">Kundtj√§nst / Admin (32k)</option>
                                    <option value="38000" selected>Order & Logistik (38k)</option>
                                    <option value="44000">Ekonomiassistent (44k)</option>
                                    <option value="52000">S√§ljchef / Operativ Chef (52k)</option>
                                    <option value="65000">Aff√§rsutvecklare (65k)</option>
                                    <option value="75000">VD / Grundare (75k)</option>
                                </select>
                            </div>
                            <div>
                                <label for="employee-count">Antal personer?</label>
                                <div class="helper-text">Hur m√•nga i teamet utf√∂r dessa uppgifter?</div>
                                <input type="number" id="employee-count" value="1" min="1" oninput="calculate()">
                            </div>
                        </div>
                        <!-- 2. TID & EFFEKTIVITET -->
                        <div class="section-title">
                            <div class="section-number">2</div>
                            Tids√•tg√•ng & Effektivitet
                        </div>
                        <div class="tabs">
                            <button class="tab-btn active" onclick="setMode('advanced')" id="btn-advanced">Detaljerad (Uppgifter)</button>
                            <button class="tab-btn" onclick="setMode('simple')" id="btn-simple">Enkel (Estimat)</button>
                        </div>
                        <!-- Advanced Mode (Default) -->
                        <div id="advanced-input">
                            <div class="grid-2">
                                <div>
                                    <label>üìß Mailhantering (st/vecka)</label>
                                    <input type="number" id="mail-vol" placeholder="Antal mail" oninput="calculate()">
                                    <div class="helper-text" style="margin-top:5px">R√§knat p√• 3 min/mail.</div>
                                </div>
                                <div>
                                    <label>üìû √Ñrenden/Samtal (st/vecka)</label>
                                    <input type="number" id="case-vol" placeholder="Antal √§renden" oninput="calculate()">
                                    <div class="helper-text" style="margin-top:5px">R√§knat p√• 6 min/√§rende.</div>
                                </div>
                            </div>
                            <div style="text-align:center; color:var(--accent); font-weight:600; margin-bottom:20px;">
                                Totalt ber√§knat: <span id="calc-hours">0</span> h/vecka
                            </div>
                        </div>
                        <!-- Simple Mode (Hidden) -->
                        <div id="simple-input" class="hidden">
                            <div class="slider-wrapper">
                                <div class="slider-header">
                                    <label>Tid p√• manuell admin / vecka</label>
                                    <div class="slider-val"><span id="hours-display">5</span> h</div>
                                </div>
                                <div class="helper-text">T.ex. flytta data mellan system, orderl√§ggning, fakturamatchning.</div>
                                <input type="range" id="hours-slider" min="1" max="40" value="5" step="1" oninput="calculate()">
                            </div>
                        </div>
                        <!-- Efficiency Slider -->
                        <div class="slider-wrapper" style="margin-top:30px; padding-top:20px; border-top:1px dashed var(--border);">
                            <div class="slider-header">
                                <label>Effektivitetsgrad</label>
                                <div class="slider-val" style="color:var(--text-light); font-size:1.2rem;"><span id="efficiency-display">80</span>%</div>
                            </div>
                            <div class="helper-text">Ingen jobbar 100% effektivt. L√§gre effektivitet = h√∂gre faktisk kostnad f√∂r varje arbetad timme. (Standard: 80%)</div>
                            <input type="range" id="efficiency-slider" min="50" max="100" value="80" step="5" oninput="calculate()">
                        </div>
                        <!-- 3. H√ÑVST√ÑNGER (ROI Levers) -->
                        <div class="section-title" style="margin-top:40px;">
                            <div class="section-number">3</div>
                            ROI H√§vst√§nger (Bonusv√§rden)
                        </div>
                        <div class="helper-text" style="margin-bottom:20px;">Markera de omr√•den som ocks√• p√•verkas av automatisering.</div>
                        <div class="levers-grid">
                            <div class="lever-card" onclick="toggleLever(event, this, 25000)">
                                <input type="checkbox">
                                <div>
                                    <span class="lever-title">Bokslutspivoten</span>
                                    <span class="lever-desc">Minskar stress & √∂vertid vid m√•nadsskiftet. (+25k)</span>
                                </div>
                            </div>
                            <div class="lever-card" onclick="toggleLever(event, this, 15000)">
                                <input type="checkbox">
                                <div>
                                    <span class="lever-title">Felmarginal</span>
                                    <span class="lever-desc">Kostnad f√∂r felaktiga ordrar/fakturor. (+15k)</span>
                                </div>
                            </div>
                            <div class="lever-card" onclick="toggleLever(event, this, 50000)">
                                <input type="checkbox">
                                <div>
                                    <span class="lever-title">Skalbarhet</span>
                                    <span class="lever-desc">V√§x utan att anst√§lla fler administrat√∂rer. (+50k)</span>
                                </div>
                            </div>
                        </div>
                        <!-- RESULTAT -->
                        <div class="results-section">
                            <div class="comparison-grid">
                                <!-- Ditt F√∂retag -->
                                <div class="result-box">
                                    <span class="res-label">Kostnad Nul√§ge (1 √•r)</span>
                                    <span class="res-value" style="color:var(--text-main)" id="cost-current">0 kr</span>
                                    <span class="res-sub">L√∂n, arbetsgivaravg. & overhead</span>
                                </div>
                                <!-- Besparing -->
                                <div class="result-box">
                                    <span class="res-label">Vunna Arbetsdagar</span>
                                    <span class="res-value" style="color:var(--accent)" id="days-saved">0</span>
                                    <span class="res-sub">Dagar per √•r frigjorda f√∂r v√§rde</span>
                                </div>
                                <!-- SAMIFY EFFEKT -->
                                <div class="result-box samify">
                                    <span class="res-label" style="color:rgba(255,255,255,0.8)">Total Aff√§rsnytta (Potential)</span>
                                    <span class="res-value" style="color:#ffffff; font-size:3rem;" id="total-potential">0 kr</span>
                                    <span class="res-sub" style="color:rgba(255,255,255,0.7)">Direkt besparing + H√§vst√•ngseffekter</span>
                                </div>
                            </div>
                            <p style="text-align:center; font-size:0.85rem; color:var(--text-light); max-width:600px; margin:0 auto;">
                                *Kalkylen inkluderar l√∂nekostnadsp√•slag (x1.55) och justering f√∂r faktisk effektivitet. H√§vst√•ngseffekter √§r estimerade v√§rden baserat p√• branschsnitt.
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW: BEHOVSANALYS (Separate) -->
            <div id="view-analysis" class="phase-view hidden h-full flex flex-col overflow-y-auto custom-scrollbar p-8 bg-slate-50 items-center">
                <div class="max-w-2xl w-full">
                    <h2 class="text-2xl font-bold text-slate-800 mb-6 text-center">Behovsanalys</h2>
                    <div id="behovsanalys-container">
                        <div id="success-message">
                            <h3>Tack! üöÄ</h3>
                            <p>Din analys √§r inskickad. Vi h√∂r av oss inom kort!</p>
                            <button onclick="location.reload()" class="mt-4 text-blue-600 underline">Starta om</button>
                        </div>
                        <div id="form-content-wrapper">
                            <div class="progress-wrapper">
                                <div class="progress-bg"><div class="progress-bar" id="progressBar"></div></div>
                                <div class="step-indicator">Steg <span id="stepCount">1</span> av 5</div>
                            </div>
                            <form id="customForm" action="https://hooks.zapier.com/hooks/catch/25909526/ue4p4vt/" method="POST">
                                <!-- STEG 1 -->
                                <div class="form-step active" data-step="1">
                                    <h3>Grundl√§ggande Info üè¢</h3>
                                    <p class="step-desc">F√∂r att vi ska f√∂rst√• din verksamhets storlek och struktur.</p>
                                    <label>Ditt namn</label>
                                    <input type="text" name="namn" required placeholder="F√∂rnamn Efternamn" />
                                    <div class="radio-group" style="margin-bottom:0">
                                        <div style="flex:1;margin-right:10px">
                                            <label>F√∂retagsnamn</label>
                                            <input type="text" name="foretag" required placeholder="Bolaget AB" />
                                        </div>
                                        <div style="flex:1">
                                            <label>Bransch</label>
                                            <input type="text" name="bransch" required placeholder="T.ex. Retail / Konsult" />
                                        </div>
                                    </div>
                                    <label>Din roll</label>
                                    <select name="roll" required>
                                        <option value disabled selected>V√§lj din roll...</option>
                                        <option value="VD/√Ñgare">VD / Grundare / √Ñgare</option>
                                        <option value="Marknad/S√§ljchef">Marknads- / S√§ljchef</option>
                                        <option value="Admin/Operations">Admin / Operations</option>
                                        <option value="Annat">Annat</option>
                                    </select>
                                    <label>Antal anst√§llda (Totalt)</label>
                                    <div class="radio-group">
                                        <div class="radio-card"><input type="radio" name="anstallda" id="size1" value="1-5" checked /><label for="size1">1-5</label></div>
                                        <div class="radio-card"><input type="radio" name="anstallda" id="size2" value="6-20" /><label for="size2">6-20</label></div>
                                        <div class="radio-card"><input type="radio" name="anstallda" id="size3" value="21-50" /><label for="size3">21-50</label></div>
                                        <div class="radio-card"><input type="radio" name="anstallda" id="size4" value="50+" /><label for="size4">50+</label></div>
                                    </div>
                                    <div class="btn-group" style="justify-content:flex-end">
                                        <button type="button" class="form-btn btn-next">N√§sta steg ‚ûî</button>
                                    </div>
                                </div>
                                <!-- STEG 2 -->
                                <div class="form-step" data-step="2">
                                    <h3>Era System üíª</h3>
                                    <p class="step-desc">Vilka verktyg anv√§nder ni idag?</p>
                                    <label>E-handelsplattform / Hemsida</label>
                                    <input type="text" name="system_webb" placeholder="T.ex. Shopify, WooCommerce..." />
                                    <label>Aff√§rs- &amp; Bokf√∂ringssystem</label>
                                    <input type="text" name="system_erp" placeholder="T.ex. Fortnox, Visma..." />
                                    <label>CRM / S√§ljst√∂d</label>
                                    <input type="text" name="system_crm" placeholder="T.ex. HubSpot, Pipedrive..." />
                                    <label>Kommunikation</label>
                                    <div class="radio-group">
                                        <div class="radio-card"><input type="radio" name="system_comm" id="comm1" value="Slack" /><label for="comm1">Slack</label></div>
                                        <div class="radio-card"><input type="radio" name="system_comm" id="comm2" value="Teams" /><label for="comm2">Teams</label></div>
                                        <div class="radio-card"><input type="radio" name="system_comm" id="comm3" value="Google" /><label for="comm3">Google/Email</label></div>
                                        <div class="radio-card"><input type="radio" name="system_comm" id="comm4" value="Annat" /><label for="comm4">Annat</label></div>
                                    </div>
                                    <div class="btn-group">
                                        <button type="button" class="form-btn btn-prev">‚¨Ö Tillbaka</button>
                                        <button type="button" class="form-btn btn-next">N√§sta steg ‚ûî</button>
                                    </div>
                                </div>
                                <!-- STEG 3 -->
                                <div class="form-step" data-step="3">
                                    <h3>Processer &amp; Utmaningar ‚öôÔ∏è</h3>
                                    <p class="step-desc">Var skaver det mest?</p>
                                    <label>Prim√§rt m√•l med automation?</label>
                                    <select name="goal_primary">
                                        <option value disabled selected>Vad √§r viktigast?</option>
                                        <option value="Spara tid">Spara tid / Minska admin</option>
                                        <option value="√ñka f√∂rs√§ljning">√ñka f√∂rs√§ljning / Konvertering</option>
                                        <option value="Minska fel">Minska manuella fel</option>
                                        <option value="Kundn√∂jdhet">B√§ttre kundupplevelse</option>
                                    </select>
                                    <label>Beskriv manuellt arbete ni g√∂r idag</label>
                                    <textarea name="process_manual_tasks" rows="3" placeholder="Vi l√§gger mycket tid p√• att..."></textarea>
                                    <label>Uppskattad tid p√• admin/vecka?</label>
                                    <div class="radio-group">
                                        <div class="radio-card"><input type="radio" name="time_waste" id="tw1" value="0-5h" /><label for="tw1">0-5 tim</label></div>
                                        <div class="radio-card"><input type="radio" name="time_waste" id="tw2" value="5-10h" /><label for="tw2">5-10 tim</label></div>
                                        <div class="radio-card"><input type="radio" name="time_waste" id="tw3" value="10-20h" /><label for="tw3">10-20 tim</label></div>
                                        <div class="radio-card"><input type="radio" name="time_waste" id="tw4" value="20h+" /><label for="tw4">20+ tim</label></div>
                                    </div>
                                    <label>Order/Transaktionsvolym per m√•nad (ca)</label>
                                    <input type="text" name="volume" placeholder="T.ex. 50 ordrar/m√•n" />
                                    <div class="btn-group">
                                        <button type="button" class="form-btn btn-prev">‚¨Ö Tillbaka</button>
                                        <button type="button" class="form-btn btn-next">N√§sta steg ‚ûî</button>
                                    </div>
                                </div>
                                <!-- STEG 4 -->
                                <div class="form-step" data-step="4">
                                    <h3>Kundtj√§nst &amp; AI ü§ñ</h3>
                                    <p class="step-desc">Om ni √§r intresserade av chatbots/AI-assistenter.</p>
                                    <label>Hur sker support idag?</label>
                                    <input type="text" name="support_current" placeholder="T.ex. Mail, telefon, Facebook..." />
                                    <label>Vanligaste √•terkommande fr√•gorna?</label>
                                    <textarea name="support_faq" rows="2" placeholder="T.ex. 'Var √§r mitt paket?', '√ñppettider'..."></textarea>
                                    <label>Om ni skaffar en AI-bot, vad ska den g√∂ra?</label>
                                    <select name="bot_goal">
                                        <option value="Support">Support &amp; Avlastning</option>
                                        <option value="Sales">S√§ljst√∂d &amp; Leads</option>
                                        <option value="Both">B√•de och</option>
                                        <option value="NotInterested">Ej aktuellt just nu</option>
                                    </select>
                                    <div class="btn-group">
                                        <button type="button" class="form-btn btn-prev">‚¨Ö Tillbaka</button>
                                        <button type="button" class="form-btn btn-next">Sista steget ‚ûî</button>
                                    </div>
                                </div>
                                <!-- STEG 5 -->
                                <div class="form-step" data-step="5">
                                    <h3>Slutspurten! üöÄ</h3>
                                    <p class="step-desc">L√§mna dina kontaktuppgifter.</p>
                                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:15px">
                                        <div>
                                            <label>Start</label>
                                            <select name="timeline">
                                                <option value="ASAP">Snarast</option>
                                                <option value="1 month">1 m√•n</option>
                                                <option value="Q3/Q4">Senare</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label>Budget</label>
                                            <select name="budget">
                                                <option value="Start">Startpaket</option>
                                                <option value="Mid">Helhet</option>
                                                <option value="Unknown">Vet ej</option>
                                            </select>
                                        </div>
                                    </div>
                                    <label>Telefonnummer</label>
                                    <input type="tel" name="telefon" required placeholder="070-123 45 67" />
                                    <label>Din e-postadress</label>
                                    <input type="email" name="email" required placeholder="namn@foretag.se" style="border:2px solid #e2e8f0" />
                                    <label>√ñnskem√•l om tid f√∂r kontakt?</label>
                                    <input type="text" name="contact_time" placeholder="T.ex. Tisdag f√∂rmiddag" />
                                    <div class="btn-group">
                                        <button type="button" class="form-btn btn-prev">‚¨Ö Tillbaka</button>
                                        <button type="submit" class="form-btn btn-submit">Skicka analys</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

        </main>

        <!-- COLUMN 2: AI & VALUE (Right - 25% Width) -->
        <aside class="w-1/4 min-w-[350px] bg-white border-l border-slate-200 flex flex-col shrink-0 shadow-xl z-20 relative">
             <div class="h-[80%] w-full relative bg-slate-50 border-b border-slate-200 flex flex-col">
                 <div class="p-3 bg-white border-b border-slate-100 flex justify-between items-center shrink-0 h-12">
                    <h3 class="font-bold text-slate-700 text-sm flex items-center gap-2"><div class="w-2 h-2 bg-indigo-600 rounded-full"></div> Samify AI</h3>
                    <span class="text-[10px] bg-green-100 text-green-700 px-2 py-0.5 rounded-full font-bold">ONLINE</span>
                 </div>
                 <div class="flex-1 relative">
                     <zapier-interfaces-chatbot-embed is-popup='false' chatbot-id='cml9x572t0029ibz47krur5g7' height='100%' width='100%' class="absolute inset-0 w-full h-full"></zapier-interfaces-chatbot-embed>
                 </div>
            </div>
            <div class="h-[20%] bg-slate-900 text-white p-6 relative overflow-hidden flex flex-col justify-center">
                <div class="absolute top-0 right-0 w-32 h-32 bg-indigo-600 rounded-full blur-3xl opacity-20 -mr-10 -mt-10"></div>
                <div class="relative z-10">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-10px text-slate-400 uppercase font-bold tracking-widest">Netto Besparing (√Ör 1)</span>
                        <i class="fa-solid fa-calculator text-green-400"></i>
                    </div>
                    <div class="text-3xl font-extrabold tracking-tight text-white mb-1" id="right-roi-value">0 kr</div>
                    <div class="text-xs text-slate-400">med AutoFlow‚Ñ¢</div>
                </div>
            </div>
        </aside>

    </div>

    <!-- JAVASCRIPT -->
    <script>
        // --- DASHBOARD LOGIC ---
        const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbymOB9LdIGV4d25c1VNxMeg6iEAWrezb9KUhmxfCLwH9nDVvlRHWmtodFsCG4wwbhOK/exec";
        let sessionStats = { total: 0, bra: 0 };

        function logga(typ) {
            var userSelect = document.getElementById('currentUser');
            var user = userSelect.value;
            
            if (!user) {
                alert("‚ö†Ô∏è Du m√•ste v√§lja ditt namn i listan h√∂gst upp f√∂rst!");
                userSelect.focus();
                return;
            }

            var foretagInput = document.getElementById('foretagInput');
            var foretagNamn = foretagInput.value;
            
            document.body.style.cursor = "wait"; 
            document.getElementById('error-box').style.display = 'none';

            var payload = { user: user, company: foretagNamn, type: typ };

            fetch(GOOGLE_SCRIPT_URL, {
                method: "POST",
                mode: "no-cors",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(payload)
            })
            .then(() => {
                console.log("Skickat!");
                uppdateraLokalStatistik(typ);
                foretagInput.value = "";
                foretagInput.focus();
                document.body.style.cursor = "default";
            })
            .catch(error => {
                console.error("Fel:", error);
                var errorBox = document.getElementById('error-box');
                errorBox.style.display = 'block';
                errorBox.innerText = "Kunde inte spara. Kolla internet.";
                document.body.style.cursor = "default";
            });
        }

        function uppdateraLokalStatistik(typ) {
            sessionStats.total++;
            if(typ === "Bra") sessionStats.bra++;
            document.getElementById('count-total').innerText = sessionStats.total;
            document.getElementById('count-bra').innerText = sessionStats.bra;
            var hitrate = sessionStats.bra > 0 ? (sessionStats.total / sessionStats.bra).toFixed(1) : "-";
            document.getElementById('hitrate').innerText = hitrate;
        }

        // --- NEW ROI LOGIC ---
        const OVERHEAD = 1.55; 
        const WEEKS_PER_YEAR = 47; 
        const HOURS_PER_MONTH = 167; 
        let mode = 'advanced';
        let softSavings = 0;

        function setMode(selectedMode) {
            mode = selectedMode;
            document.getElementById('btn-simple').classList.toggle('active', mode === 'simple');
            document.getElementById('btn-advanced').classList.toggle('active', mode === 'advanced');
            document.getElementById('simple-input').classList.toggle('hidden', mode !== 'simple');
            document.getElementById('advanced-input').classList.toggle('hidden', mode !== 'advanced');
            calculate();
        }

        function toggleLever(e, card, value) {
            const checkbox = card.querySelector('input');
            if (e.target !== checkbox) checkbox.checked = !checkbox.checked;
            card.classList.toggle('active', checkbox.checked);
            if (checkbox.checked) softSavings += value; else softSavings -= value;
            calculate();
        }

        function calculate() {
            const salary = parseInt(document.getElementById('role-select').value);
            const employees = parseInt(document.getElementById('employee-count').value) || 1;
            const efficiency = parseInt(document.getElementById('efficiency-slider').value);
            
            document.getElementById('efficiency-display').innerText = efficiency;

            let weeklyHours = 0;
            if (mode === 'simple') {
                weeklyHours = parseInt(document.getElementById('hours-slider').value);
                document.getElementById('hours-display').innerText = weeklyHours;
            } else {
                const mails = parseInt(document.getElementById('mail-vol').value) || 0;
                const cases = parseInt(document.getElementById('case-vol').value) || 0;
                weeklyHours = ((mails * 3) + (cases * 6)) / 60;
                document.getElementById('calc-hours').innerText = Math.round(weeklyHours * 10) / 10;
            }

            const totalWeeklyHours = weeklyHours * employees;
            const monthlyCost = salary * OVERHEAD;
            const effectiveHourlyRate = monthlyCost / (HOURS_PER_MONTH * (efficiency / 100));
            const annualCost = totalWeeklyHours * WEEKS_PER_YEAR * effectiveHourlyRate;
            const daysSaved = (totalWeeklyHours * WEEKS_PER_YEAR) / 8;
            const totalPotential = annualCost + softSavings;

            animateValue("cost-current", Math.round(annualCost), " kr");
            animateValue("days-saved", Math.round(daysSaved), " dagar");
            animateValue("total-potential", Math.round(totalPotential), " kr");
            
            // Update sidebar value as well
            document.getElementById('right-roi-value').innerText = Math.round(totalPotential).toLocaleString('sv-SE') + " kr";
        }

        function animateValue(id, endValue, suffix) {
            const obj = document.getElementById(id);
            obj.innerText = endValue.toLocaleString('sv-SE') + suffix;
        }

        // --- APP NAVIGATION ---
        function setPhase(phase) {
            document.querySelectorAll('.phase-btn').forEach(b => {
                b.classList.remove('active', 'bg-white', 'text-indigo-900', 'shadow-sm');
                b.classList.add('text-indigo-100', 'hover:bg-white/10');
            });
            document.getElementById('btn-' + phase).classList.add('active', 'bg-white', 'text-indigo-900', 'shadow-sm');
            document.getElementById('btn-' + phase).classList.remove('text-indigo-100', 'hover:bg-white/10');
            
            document.querySelectorAll('.phase-view').forEach(v => v.classList.add('hidden'));
            document.getElementById('view-' + phase).classList.remove('hidden');

            if(phase === 'presentation' && !tipsShown) {
                showDailyTip();
                tipsShown = true;
            }
        }

        // --- SCRIPT DATA & LOGIC ---
        // (Tracks, Pitches, Objections, Arsenal kept same as before)
        const tracks = {
            A: { name: "Operativ / S√§ljchef", qs: ["1. Kan du beskriva resan f√∂r en kundorder fr√•n webshop till bokf√∂rt verifikat?", "2. Hur mycket tid l√§gger s√§ljteamet p√• admin j√§mf√∂rt med att st√§nga aff√§rer?", "4. Vilka uppgifter √§r s√• monotona att ni sk√§ms √∂ver att l√•ta en m√§nniska g√∂ra dem?", "5. Om din admin-person var sjuk i tv√• veckor, vad skulle stanna av helt?"]},
            B: { name: "Ekonomi / CFO", qs: ["3. N√§r ni st√§nger i CRM:et, hur hamnar datan i ekonomisystemet idag?", "6. Hur m√•nga dagar tar ert m√•nadsbokslut och vad tar mest tid?", "7. Hur matchar ni inbetalningar p√• banken med ordernummer idag?", "8. Vad kostar det i tid/pengar n√§r en faktura blir fel p.g.a. m√§nskliga faktorn?"]},
            C: { name: "Skalbarhet / Grundare", qs: ["11. Om ni dubblar volymen n√§sta kvartal, hur m√•nga nyanst√§llningar kr√§vs?", "14. Hur mycket 'Shadow IT' (egna Excel-l√∂sningar) har ni i organisationen?", "13. Vad hindrar er fr√•n att ta in 20% fler kunder med nuvarande personalstyrka?", "15. Hur planerar ni att anv√§nda AI f√∂r att vinna mot era konkurrenter?"]},
            D: { name: "Service / Support", qs: ["16. I hur m√•nga system m√•ste personalen leta f√∂r att svara p√• en kundfr√•ga?", "19. Vilka √§r de 3 vanligaste fr√•gorna som egentligen √§r rena 'robot-svar'?", "17. Hur mycket tid l√§ggs p√• att manuellt skicka ut kollinummer?", "18. Hur skulle kundupplevelsen √§ndras om all historik fanns framme direkt?"]}
        };
        const pitches = {
            straight: { title: "Raka & √Ñrliga", text: "Hej [Namn], X fr√•n Samify. Jag ska vara helt rak: Jag letar efter bolag som fastnat i 'App-f√§llan' ‚Äì allts√• d√§r ni har moderna system, men tvingas agera manuell l√§nk emellan dem.\n\n√Ñr det en flaskhals ni k√§nner igen er i, eller flyter datan av sig sj√§lvt hos er?", track: "A" },
            cfo: { title: "CFO / Ekonomi", text: "Hej [Namn], kort fr√•ga fr√•n Samify:\n\nN√§r ni st√§nger b√∂ckerna vid m√•nadsskiftet ‚Äì litar ni p√• siffrorna direkt, eller kr√§vs det dagar av detektivarbete och manuell matchning f√∂r att allt ska st√§mma?", track: "B" },
            pain: { title: "Sm√§rtan (Operativ)", text: "Hej [Namn], X fr√•n Samify. Vi hj√§lper bolag att ta bort de d√§r repetitiva uppgifterna som d√∂dar s√§ljmoralen.\n\nEn klassiker vi ser √§r att s√§ljare l√§gger 20% av sin tid p√• att knappa in ordrar i aff√§rssystemet ist√§llet f√∂r att dra in nya aff√§rer. Hur ser den f√∂rdelningen ut hos er ‚Äì f√•r s√§ljarna s√§lja eller m√•ste de administrera?", track: "A" },
            scale: { title: "Skalbarhet", text: "Hej [Namn], jag ser att ni v√§xer s√• det knakar!\n\nM√•nga i er fas uppt√§cker tyv√§rr att admin-kostnaden √§ter upp marginalen n√§r volymen √∂kar. Har ni riggat systemen f√∂r att hantera dubbla oms√§ttningen n√§sta √•r, eller m√•ste ni 'kasta in mer folk' f√∂r att l√∂sa det?", track: "C" },
            social: { title: "Igenk√§nning", text: "Hej [Namn], anledningen till att jag ringer √§r att vi hj√§lper flera bolag som k√∂r just [Fortnox/Shopify].\n\nM√•nga av dem hade grym koll p√• f√∂rs√§ljningen, men slet med att bokf√∂ringen alltid sl√§pade efter p√• grund av manuell handp√•l√§ggning. √Ñr det d√§r en utmaning du k√§nner igen, eller har ni automatiserat kopplingen helt?", track: "A" },
            curious: { title: "Nyfikenhet", text: "Hej [Namn], jag ringer fr√•n Samify. Vi g√∂r en scanning av hur bolag i [Bransch] hanterar sina datafl√∂den.\n\nM√•nga vi pratar med har system som √§r bra var f√∂r sig, men som inte riktigt 'pratar med varandra'. √Ñr det en n√∂t ni har kn√§ckt, eller ligger det p√• bordet att l√∂sa fram√∂ver?", track: "D" },
            provoke: { title: "Provocerande", text: "Hej [Namn], X fr√•n Samify h√§r. Jag har en lite annorlunda fr√•ga f√∂r att kolla hur s√•rbara era processer √§r:\n\nOm er b√§sta administrat√∂r blir sjukskriven imorgon ‚Äì stannar era viktigaste fl√∂den av d√•, eller rullar systemen vidare av sig sj√§lva?", track: "A" }
        };
        const objections = [
            { cat: "A", trig: "1. Zapier √§r amerikanskt. GDPR?", resp: "Jag f√∂rst√•r oron helt, det √§r en kritisk fr√•ga f√∂r alla svenska bolag idag. Det √§r viktigt att skilja p√• lagring och processering. Zapier har certifierat sig enligt Data Privacy Framework (DPF) och anv√§nder Standard Contractual Clauses (SCCs) vilket ger en laglig grund f√∂r √∂verf√∂ringen. Men f√∂r att vara extra s√§kra kan vi designa era fl√∂den med principen om dataminimering." },
            { cat: "A", trig: "2. Vi till√•ter inte tredjeparts√•tkomst", resp: "Det √§r en klok policy. Men paradoxalt nog √§r manuell datahantering ofta en st√∂rre s√§kerhetsrisk. N√§r vi integrerar via API anv√§nder vi 'Scoped Access' ‚Äì det inneb√§r att vi ger automationen en nyckel som bara kan g√∂ra exakt det den ska (t.ex. 'Skapa Faktura') och inget annat. Den kan inte l√§sa era l√∂ner eller se era bankkonton." },
            { cat: "B", trig: "6. Unika och komplexa processer", resp: "Det √§r faktiskt det b√§sta argumentet f√∂r automation. 'Unik' betyder ofta bara att den f√∂ljer specifika regler. Om ni kan skriva ner reglerna (t.ex. 'Om ordern √§r √∂ver 10 000 kr, mejla chefen'), s√• √§r det inte komplext f√∂r en dator ‚Äì det √§r bara logik." },
            { cat: "B", trig: "7. Testat sj√§lva, slutade fungera", resp: "DIY-automation √§r sk√∂rt. N√§r personen som byggde det slutar, eller n√§r ett API uppdateras, faller allt. Det √§r precis d√§rf√∂r Samify finns som en tj√§nst. Ni k√∂per inte bara bygget, ni k√∂per 'Drift'. Vi √∂vervakar fl√∂dena dygnet runt." },
            { cat: "C", trig: "11. Det √§r f√∂r dyrt (Har personal)", resp: "L√•t oss r√§kna p√• alternativkostnaden. Om din s√§ljadministrat√∂r l√§gger 2 timmar om dagen p√• att flytta data, √§r det ca 40 timmar i m√•naden. Med sociala avgifter och overhead kostar det er antagligen runt 20 000 - 30 000 kr i m√•naden i ren 'copy-paste'-tid." },
            { cat: "C", trig: "13. Vi kan g√∂ra det internt", resp: "Er IT-person √§r v√§rdefull. Vill ni att hen ska l√§gga 10 timmar i veckan p√• att fels√∂ka en webhook, eller ska hen fokusera p√• er k√§rnverksamhet? Intern automation blir ofta 'Shadow IT' ‚Äì o√∂vervakad och odokumenterad." }
        ];
        const arsenalQuestions = [
            { cat: "Operativ Tid", q: "1. Kan du beskriva resan f√∂r en kundorder fr√•n webshop till bokf√∂rt verifikat?" },
            { cat: "Operativ Tid", q: "2. Hur mycket tid l√§gger s√§ljteamet p√• admin j√§mf√∂rt med att st√§nga aff√§rer?" },
            { cat: "Ekonomi/CFO", q: "6. Hur m√•nga dagar tar ert m√•nadsbokslut och vad tar mest tid?" },
            { cat: "Ekonomi/CFO", q: "7. Hur matchar ni inbetalningar p√• banken med ordernummer idag?" },
            { cat: "Skalbarhet", q: "11. Om ni dubblar volymen n√§sta kvartal, hur m√•nga nyanst√§llningar kr√§vs?" },
            { cat: "Service/Support", q: "16. I hur m√•nga system m√•ste personalen leta f√∂r att svara p√• en kundfr√•ga?" }
        ];
        const tipPool4 = [{ title: "Detektiven", text: "En bra s√§ljare antar ingenting. St√§ll fr√•gor som gr√§ver djupare." }, { title: "V√•ga Tystnaden", text: "Prata inte s√∂nder aff√§ren. L√•t kunden t√§nka." }, { title: "S√§lj Tidsmaskinen", text: "S√§lj inte 'API-kopplingar'. S√§lj k√§nslan av att g√• hem kl 17." }, { title: "It's Toasted", text: "Ber√§tta om ER process och trygghet som om den vore unik." }];
        const tipPool5 = [{ title: "Tinder-regeln", text: "V√•ga fr√•ga om aff√§ren! F√• ett ja, ett nej, eller en plan." }, { title: "Suck it up", text: "Dyker hinder upp? L√∂s det." }, { title: "Katedralbyggaren", text: "Se dagens samtal som en del av att bygga framg√•ng." }, { title: "Byt Samtals√§mne", text: "Fastnar kunden i budget? Byt till risk." }, { title: "Heinz-effekten", text: "Tvinga kunden att t√§nka l√∂sningen sj√§lv." }];

        function showDailyTip() {
            const day = new Date().getDay(); 
            let t4 = tipPool4[day % 4] || tipPool4[0];
            let t5 = tipPool5[day % 5] || tipPool5[0];
            document.getElementById('dynamic-tip-4').innerHTML = `<h4 class="font-bold text-slate-800 text-sm">${t4.title}</h4><p class="text-xs text-slate-600 mt-1">${t4.text}</p>`;
            document.getElementById('dynamic-tip-5').innerHTML = `<h4 class="font-bold text-slate-800 text-sm">${t5.title}</h4><p class="text-xs text-slate-600 mt-1">${t5.text}</p>`;
            document.getElementById('tip-modal').classList.remove('hidden');
        }
        function closeTip() { document.getElementById('tip-modal').classList.add('hidden'); }

        function startFlow(pitchKey) {
            const pitch = pitches[pitchKey];
            const track = tracks[pitch.track];
            document.getElementById('script-placeholder').classList.add('hidden');
            document.getElementById('script-content').classList.remove('hidden');
            document.getElementById('script-opener-text').innerText = pitch.text;
            document.getElementById('track-name').innerText = track.name;
            const qList = document.getElementById('script-questions-list');
            qList.innerHTML = "";
            track.qs.forEach(q => { qList.innerHTML += `<li class="flex items-start gap-3"><input type="checkbox" class="mt-1 w-4 h-4 accent-indigo-600"><span class="text-slate-700 font-medium">${q}</span></li>`; });
            resetSteps();
            document.querySelectorAll('.pitch-select-btn').forEach(b => { b.classList.remove('ring-2', 'ring-indigo-500', 'bg-indigo-50'); if(b.onclick.toString().includes(`'${pitchKey}'`)) { b.classList.add('ring-2', 'ring-indigo-500', 'bg-indigo-50'); } });
        }
        function resetSteps() {
            document.getElementById('step-1').classList.add('active');
            document.getElementById('step-2').classList.remove('active', 'hidden'); document.getElementById('step-2').classList.add('hidden');
            document.getElementById('step-3').classList.remove('active', 'hidden'); document.getElementById('step-3').classList.add('hidden');
            document.getElementById('step-4').classList.remove('active', 'hidden'); document.getElementById('step-4').classList.add('hidden');
            document.getElementById('quick-counters').classList.add('hidden');
        }
        function nextStep(stepNum) {
            const step = document.getElementById(`step-${stepNum}`);
            step.classList.remove('hidden');
            setTimeout(() => step.classList.add('active'), 10);
            step.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        function resetScript() {
            document.getElementById('script-content').classList.add('hidden');
            document.getElementById('script-placeholder').classList.remove('hidden');
            document.querySelectorAll('.pitch-select-btn').forEach(b => b.classList.remove('ring-2', 'ring-indigo-500', 'bg-indigo-50'));
        }
        function toggleObjection(idx) {
            const el = document.getElementById('ans-' + idx);
            const icon = document.getElementById('icon-' + idx);
            el.classList.toggle('open'); icon.classList.toggle('rotate-180');
        }
        function renderObjections(filter = "") {
            const list = document.getElementById('objections-list');
            list.innerHTML = "";
            objections.filter(o => o.trig.toLowerCase().includes(filter.toLowerCase())).forEach((obj, idx) => {
                let badgeColor = obj.cat === "A" ? "bg-red-100 text-red-600" : (obj.cat === "B" ? "bg-blue-100 text-blue-600" : "bg-green-100 text-green-600");
                list.innerHTML += `<div class="bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm hover:shadow-md transition group"><button onclick="toggleObjection(${idx})" class="w-full text-left p-4 font-bold text-slate-700 hover:text-indigo-600 flex justify-between items-center gap-2"><span class="flex items-center gap-2"><span class="text-[10px] font-bold px-2 py-0.5 rounded ${badgeColor}">KAT ${obj.cat}</span>${obj.trig}</span><i id="icon-${idx}" class="fa-solid fa-chevron-down text-xs text-slate-300 transition-transform duration-300"></i></button><div id="ans-${idx}" class="objection-content bg-slate-50"><p class="p-6 border-t border-slate-200 text-slate-600 leading-relaxed text-sm whitespace-pre-line">${obj.resp}</p></div></div>`;
            });
        }
        function renderArsenal() {
            const list = document.getElementById('arsenal-list');
            list.innerHTML = "";
            arsenalQuestions.forEach((item) => {
                let catColor = item.cat.includes("Ekonomi") ? "text-green-500" : "text-indigo-400";
                list.innerHTML += `<div class="bg-white p-4 rounded-lg border border-slate-100 shadow-sm text-sm"><span class="text-[10px] font-bold ${catColor} uppercase tracking-wider mb-1 block">${item.cat}</span><p class="text-slate-700 font-medium">"${item.q}"</p></div>`;
            });
        }
        document.getElementById('objSearch').addEventListener('input', (e) => renderObjections(e.target.value));

        // --- FORM LOGIC ---
        function initMultiStepForm() {
            const form = document.getElementById('customForm');
            if(!form) return;
            const steps = form.querySelectorAll('.form-step');
            const nextBtns = form.querySelectorAll('.btn-next');
            const prevBtns = form.querySelectorAll('.btn-prev');
            const progressBar = document.getElementById('progressBar');
            const stepCountSpan = document.getElementById('stepCount');
            const submitBtn = form.querySelector('.btn-submit');
            const formWrapper = document.getElementById('form-content-wrapper');
            const successMessage = document.getElementById('success-message');
            let currentStep = 0;
            function updateForm() {
                steps.forEach((step, index) => { step.classList.toggle('active', index === currentStep); });
                if(steps.length > 0 && progressBar) { const progress = ((currentStep + 1) / steps.length) * 100; progressBar.style.width = progress + '%'; }
                if(stepCountSpan) stepCountSpan.textContent = currentStep + 1;
                document.getElementById('behovsanalys-container')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            nextBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const currentStepEl = steps[currentStep];
                    const inputs = currentStepEl.querySelectorAll('input, select, textarea');
                    let stepIsValid = true;
                    for (const input of inputs) { if (!input.checkValidity()) { stepIsValid = false; input.reportValidity(); break; } }
                    if (stepIsValid && currentStep < steps.length - 1) { currentStep++; updateForm(); }
                });
            });
            prevBtns.forEach(btn => { btn.addEventListener('click', () => { if (currentStep > 0) { currentStep--; updateForm(); } }); });
            form.addEventListener('submit', async function(e) {
                e.preventDefault(); const originalBtnText = submitBtn.innerText; submitBtn.innerText = "Skickar..."; submitBtn.disabled = true;
                const formData = new FormData(form); const data = Object.fromEntries(formData.entries());
                try {
                    const response = await fetch(form.action, { method: 'POST', body: JSON.stringify(data) });
                    if (response.ok) { if(formWrapper) formWrapper.style.display = 'none'; if(successMessage) successMessage.style.display = 'block'; } else { alert("Fel vid inskickning."); submitBtn.innerText = originalBtnText; submitBtn.disabled = false; }
                } catch (error) { alert("N√§tverksfel."); submitBtn.innerText = originalBtnText; submitBtn.disabled = false; }
            });
            updateForm();
        }

        let tipsShown = false;
        window.onload = () => {
            renderObjections();
            renderArsenal();
            calculate();
            initMultiStepForm();
        };
    </script>
</body>
</html>